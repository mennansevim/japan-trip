<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Japonya Seyahat Planlayƒ±cƒ±</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg: #000000;
      --surface: #1c1c1e;
      --surface-2: #2c2c2e;
      --surface-3: #3a3a3c;
      --text: #ffffff;
      --text-secondary: #8e8e93;
      --accent: #ff6b9d;
      --accent-2: #c084fc;
      --success: #30d158;
      --warning: #ffd60a;
      --danger: #ff453a;
      --border: rgba(255, 255, 255, 0.1);
      --radius: 16px;
      --radius-sm: 12px;
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }
    html { scroll-behavior: smooth; }
    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
      background: var(--bg);
      color: var(--text);
      min-height: 100vh;
      line-height: 1.5;
      -webkit-font-smoothing: antialiased;
    }

    .header {
      padding: 60px 24px 40px;
      text-align: center;
      max-width: 800px;
      margin: 0 auto;
    }
    .header-icon {
      width: 80px; height: 80px;
      margin: 0 auto 24px;
      background: linear-gradient(135deg, var(--accent), var(--accent-2));
      border-radius: 20px;
      display: flex; align-items: center; justify-content: center;
      font-size: 40px;
    }
    .header h1 { font-size: 34px; font-weight: 700; letter-spacing: -0.5px; margin-bottom: 12px; }
    .header p { font-size: 17px; color: var(--text-secondary); max-width: 500px; margin: 0 auto; }

    .container { max-width: 900px; margin: 0 auto; padding: 0 24px 60px; }

    .card {
      background: var(--surface);
      border-radius: var(--radius);
      margin-bottom: 16px;
      overflow: hidden;
    }
    .card-header {
      padding: 20px 24px 16px;
      border-bottom: 1px solid var(--border);
      display: flex; align-items: center; gap: 12px;
    }
    .card-header-icon {
      width: 36px; height: 36px;
      background: var(--surface-2);
      border-radius: 10px;
      display: flex; align-items: center; justify-content: center;
      font-size: 18px;
    }
    .card-header h2 { font-size: 17px; font-weight: 600; }
    .card-header-badge {
      margin-left: auto;
      font-size: 13px;
      padding: 4px 10px;
      border-radius: 8px;
      background: rgba(255, 107, 157, 0.15);
      color: var(--accent);
      font-weight: 600;
    }
    .card-body { padding: 8px 0; }

    .input-row {
      display: flex; align-items: center; justify-content: space-between;
      padding: 14px 24px;
      border-bottom: 1px solid var(--border);
    }
    .input-row:last-child { border-bottom: none; }
    .input-row-left { display: flex; align-items: center; gap: 14px; flex: 1; }
    .input-icon {
      width: 32px; height: 32px;
      background: var(--surface-2);
      border-radius: 8px;
      display: flex; align-items: center; justify-content: center;
      font-size: 16px; flex-shrink: 0;
    }
    .input-label { font-size: 15px; color: var(--text); }
    .input-sublabel { font-size: 13px; color: var(--text-secondary); margin-top: 2px; }

    .input-row input[type="number"],
    .input-row input[type="date"] {
      width: 140px; padding: 10px 14px;
      background: var(--surface-2); border: none;
      border-radius: var(--radius-sm);
      color: var(--text); font-family: inherit; font-size: 15px;
      text-align: right; outline: none;
    }
    .input-row input:focus { background: var(--surface-3); }
    .input-row input[type="date"] { width: 160px; color-scheme: dark; }

    .stepper {
      display: flex; align-items: center; gap: 4px;
      background: var(--surface-2);
      border-radius: var(--radius-sm); padding: 4px;
    }
    .stepper-btn {
      width: 36px; height: 36px; border: none;
      background: transparent; color: var(--accent);
      font-size: 20px; font-weight: 500; cursor: pointer;
      border-radius: 8px;
      display: flex; align-items: center; justify-content: center;
    }
    .stepper-btn:hover { background: var(--surface-3); }
    .stepper-value { width: 40px; text-align: center; font-size: 17px; font-weight: 600; }

    .person-cards { display: flex; gap: 12px; padding: 16px 24px; }
    .person-card {
      flex: 1; background: var(--surface-2);
      border-radius: var(--radius-sm); padding: 16px; text-align: center;
    }
    .person-card-icon { font-size: 32px; margin-bottom: 8px; }
    .person-card-label { font-size: 13px; color: var(--text-secondary); margin-bottom: 8px; }

    .stats-grid {
      display: grid; grid-template-columns: repeat(2, 1fr);
      gap: 12px; padding: 16px 24px;
    }
    @media (max-width: 600px) { .stats-grid { grid-template-columns: 1fr; } }
    .stat-box { background: var(--surface-2); border-radius: var(--radius-sm); padding: 16px; }
    .stat-label { font-size: 13px; color: var(--text-secondary); margin-bottom: 6px; }
    .stat-value { font-size: 24px; font-weight: 700; }
    .stat-value.success { color: var(--success); }
    .stat-value.danger { color: var(--danger); }

    .progress-section { padding: 24px; text-align: center; }
    .progress-circle-container { position: relative; width: 180px; height: 180px; margin: 0 auto 20px; }
    .progress-circle { transform: rotate(-90deg); }
    .progress-circle-bg { fill: none; stroke: var(--surface-2); stroke-width: 12; }
    .progress-circle-fill {
      fill: none; stroke: url(#progressGradient);
      stroke-width: 12; stroke-linecap: round;
      stroke-dasharray: 502; stroke-dashoffset: 502;
      transition: stroke-dashoffset 1s ease-out;
    }
    .progress-text { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center; }
    .progress-percent { font-size: 42px; font-weight: 700; }
    .progress-label { font-size: 13px; color: var(--text-secondary); }
    .progress-message { font-size: 15px; color: var(--text-secondary); }

    .countdown { display: flex; justify-content: center; gap: 16px; padding: 20px 24px; }
    .countdown-item { text-align: center; }
    .countdown-value { font-size: 32px; font-weight: 700; color: var(--accent); }
    .countdown-label { font-size: 12px; color: var(--text-secondary); text-transform: uppercase; }

    .savings-row { display: flex; gap: 12px; padding: 16px 24px; }
    .savings-box {
      flex: 1;
      background: linear-gradient(135deg, rgba(255, 107, 157, 0.1), rgba(192, 132, 252, 0.1));
      border: 1px solid rgba(255, 107, 157, 0.2);
      border-radius: var(--radius-sm); padding: 16px; text-align: center;
    }
    .savings-label { font-size: 12px; color: var(--text-secondary); margin-bottom: 6px; }
    .savings-value { font-size: 20px; font-weight: 700; color: var(--accent); }

    .info-list { padding: 8px 0; }
    .info-item {
      display: flex; align-items: flex-start; gap: 14px;
      padding: 14px 24px; border-bottom: 1px solid var(--border);
    }
    .info-item:last-child { border-bottom: none; }
    .info-item-icon {
      width: 32px; height: 32px; border-radius: 8px;
      display: flex; align-items: center; justify-content: center;
      font-size: 16px; flex-shrink: 0;
    }
    .info-item-icon.success { background: rgba(48, 209, 88, 0.15); }
    .info-item-icon.warning { background: rgba(255, 214, 10, 0.15); }
    .info-item-icon.danger { background: rgba(255, 69, 58, 0.15); }
    .info-item-content { flex: 1; }
    .info-item-title { font-size: 15px; font-weight: 500; margin-bottom: 2px; }
    .info-item-desc { font-size: 13px; color: var(--text-secondary); }
    .info-item-badge { font-size: 13px; font-weight: 500; padding: 4px 10px; border-radius: 6px; }
    .info-item-badge.success { background: rgba(48, 209, 88, 0.15); color: var(--success); }
    .info-item-badge.warning { background: rgba(255, 214, 10, 0.15); color: var(--warning); }
    .info-item-badge.danger { background: rgba(255, 69, 58, 0.15); color: var(--danger); }

    .button-row { display: flex; gap: 12px; padding: 16px 24px; }
    .btn {
      flex: 1; padding: 14px 20px; border: none;
      border-radius: var(--radius-sm);
      font-family: inherit; font-size: 15px; font-weight: 600;
      cursor: pointer; transition: all 0.2s;
    }
    .btn-primary { background: linear-gradient(135deg, var(--accent), var(--accent-2)); color: white; }
    .btn-primary:hover { opacity: 0.9; transform: scale(1.02); }
    .btn-secondary { background: var(--surface-2); color: var(--text); }
    .btn-secondary:hover { background: var(--surface-3); }

    .notice {
      display: flex; align-items: center; gap: 12px;
      padding: 14px 24px; background: var(--surface-2);
      margin: 0 24px 16px; border-radius: var(--radius-sm);
    }
    .notice-icon { font-size: 20px; }
    .notice-text { font-size: 13px; color: var(--text-secondary); }

    .illustration { display: flex; justify-content: center; padding: 20px; gap: 8px; }
    .illustration-item { font-size: 40px; opacity: 0.8; animation: float 3s ease-in-out infinite; }
    .illustration-item:nth-child(2) { animation-delay: 0.5s; }
    .illustration-item:nth-child(3) { animation-delay: 1s; }
    .illustration-item:nth-child(4) { animation-delay: 1.5s; }
    .illustration-item:nth-child(5) { animation-delay: 2s; }
    @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-6px); } }

    .footer { text-align: center; padding: 40px 24px; color: var(--text-secondary); font-size: 13px; }

    /* Activity Styles */
    .activity-category {
      padding: 16px 24px 8px;
      font-size: 13px; font-weight: 600;
      color: var(--text-secondary);
      text-transform: uppercase; letter-spacing: 0.5px;
      display: flex; align-items: center; gap: 8px;
    }

    .activity-item {
      display: flex; align-items: center; gap: 14px;
      padding: 14px 24px;
      border-bottom: 1px solid var(--border);
      cursor: pointer; transition: background 0.2s;
    }
    .activity-item:hover { background: var(--surface-2); }
    .activity-item.checked { background: rgba(48, 209, 88, 0.08); }

    .activity-checkbox {
      width: 24px; height: 24px;
      border: 2px solid var(--surface-3);
      border-radius: 50%;
      display: flex; align-items: center; justify-content: center;
      flex-shrink: 0; transition: all 0.2s;
    }
    .activity-item.checked .activity-checkbox {
      background: var(--success); border-color: var(--success);
    }
    .activity-checkbox::after {
      content: '‚úì'; color: white; font-size: 14px; font-weight: 700;
      opacity: 0; transition: opacity 0.2s;
    }
    .activity-item.checked .activity-checkbox::after { opacity: 1; }

    .activity-icon {
      width: 44px; height: 44px;
      background: var(--surface-2);
      border-radius: 12px;
      display: flex; align-items: center; justify-content: center;
      font-size: 22px; flex-shrink: 0;
    }
    .activity-item.checked .activity-icon { background: rgba(48, 209, 88, 0.15); }

    .activity-content { flex: 1; min-width: 0; }
    .activity-name { font-size: 15px; font-weight: 500; margin-bottom: 2px; }
    .activity-location { font-size: 13px; color: var(--text-secondary); }

    .activity-actions { display: flex; align-items: center; gap: 8px; }
    .activity-info-btn {
      width: 32px; height: 32px;
      background: var(--surface-3);
      border: none; border-radius: 8px;
      color: var(--text-secondary);
      font-size: 16px; cursor: pointer;
      display: flex; align-items: center; justify-content: center;
      transition: all 0.2s;
    }
    .activity-info-btn:hover { background: var(--accent); color: white; }

    .activity-price {
      font-size: 14px; font-weight: 600;
      color: var(--accent); white-space: nowrap;
      text-align: right;
    }
    .activity-price-note {
      font-size: 11px; color: var(--text-secondary); font-weight: 400;
    }

    .activities-total {
      display: flex; justify-content: space-between; align-items: center;
      padding: 16px 24px; background: var(--surface-2);
      margin: 16px 24px; border-radius: var(--radius-sm);
    }
    .activities-total-label { font-size: 14px; color: var(--text-secondary); }
    .activities-total-value { font-size: 20px; font-weight: 700; color: var(--accent); }

    .map-button-container {
      display: flex; flex-direction: column; align-items: center;
      padding: 16px 24px 24px; gap: 8px;
    }
    .map-button {
      display: flex; align-items: center; justify-content: center; gap: 10px;
      width: 100%; max-width: 320px;
      padding: 14px 24px;
      background: linear-gradient(135deg, #4285f4, #34a853);
      border: none; border-radius: 12px;
      color: white; font-family: inherit;
      font-size: 15px; font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
      box-shadow: 0 4px 12px rgba(66, 133, 244, 0.3);
    }
    .map-button:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(66, 133, 244, 0.4);
    }
    .map-button:disabled {
      background: var(--surface-3);
      box-shadow: none;
      cursor: not-allowed;
      transform: none;
    }
    .map-button svg { flex-shrink: 0; }
    .map-button-hint {
      font-size: 12px; color: var(--text-secondary);
    }

    /* Trip Advisor - Konaklama Planƒ± */
    .trip-advisor-card { background: linear-gradient(180deg, rgba(30,58,138,0.1) 0%, var(--card) 30%); }
    .trip-advisor-intro { 
      padding: 0 24px 16px;
      color: var(--text-dim);
      font-size: 14px;
    }
    .city-breakdown { padding: 0 24px; }
    .no-selection-msg {
      text-align: center;
      padding: 32px;
      color: var(--text-dim);
    }
    .no-selection-icon { font-size: 48px; display: block; margin-bottom: 12px; }
    .city-plan-item {
      background: rgba(255,255,255,0.03);
      border-radius: 12px;
      padding: 16px;
      margin-bottom: 12px;
      border-left: 4px solid var(--accent);
    }
    .city-plan-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 12px;
    }
    .city-plan-name {
      font-size: 18px;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .city-plan-nights {
      background: var(--accent);
      color: white;
      padding: 4px 12px;
      border-radius: 20px;
      font-size: 13px;
      font-weight: 600;
    }
    .city-plan-activities {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-top: 8px;
    }
    .city-activity-tag {
      background: rgba(255,255,255,0.05);
      padding: 4px 10px;
      border-radius: 8px;
      font-size: 12px;
      color: var(--text-dim);
    }
    .hotel-pricing-info {
      margin: 20px 24px;
      padding: 16px;
      background: rgba(255,255,255,0.02);
      border-radius: 12px;
    }
    .pricing-header {
      display: flex;
      align-items: center;
      gap: 8px;
      font-weight: 600;
      margin-bottom: 12px;
    }
    .pricing-icon { font-size: 20px; }
    .pricing-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 12px;
    }
    @media (max-width: 600px) {
      .pricing-grid { grid-template-columns: 1fr; }
    }
    .price-card {
      text-align: center;
      padding: 12px;
      border-radius: 10px;
      border: 1px solid var(--border);
    }
    .price-card.budget { 
      border-color: #22c55e;
      background: rgba(34,197,94,0.05);
    }
    .price-card.midrange { 
      border-color: #f59e0b;
      background: rgba(245,158,11,0.05);
    }
    .price-card.premium { 
      border-color: #a855f7;
      background: rgba(168,85,247,0.05);
    }
    .price-label {
      font-weight: 600;
      font-size: 12px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-bottom: 4px;
    }
    .price-card.budget .price-label { color: #22c55e; }
    .price-card.midrange .price-label { color: #f59e0b; }
    .price-card.premium .price-label { color: #a855f7; }
    .price-range {
      font-size: 16px;
      font-weight: 700;
      margin-bottom: 2px;
    }
    .price-desc {
      font-size: 11px;
      color: var(--text-dim);
    }
    .trip-summary {
      margin: 0 24px 24px;
      padding: 16px;
      background: linear-gradient(135deg, rgba(30,58,138,0.2), rgba(59,130,246,0.1));
      border-radius: 12px;
      border: 1px solid rgba(59,130,246,0.3);
    }
    .summary-header {
      font-weight: 600;
      margin-bottom: 12px;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .summary-content { font-size: 14px; line-height: 1.8; }
    .summary-item {
      display: flex;
      justify-content: space-between;
      padding: 6px 0;
      border-bottom: 1px dashed rgba(255,255,255,0.1);
    }
    .summary-item:last-child { border-bottom: none; }
    .summary-total {
      margin-top: 12px;
      padding-top: 12px;
      border-top: 2px solid var(--accent);
      font-weight: 700;
      font-size: 16px;
      display: flex;
      justify-content: space-between;
    }

    /* Shopping Guide */
    .shopping-guide { padding: 0 24px 24px; }
    .shopping-city { margin-bottom: 20px; }
    .shopping-city-header {
      font-size: 16px; font-weight: 600;
      padding: 12px 0 8px;
      border-bottom: 1px solid var(--border);
      margin-bottom: 12px;
    }
    .shopping-list { display: flex; flex-direction: column; gap: 8px; }
    .shopping-item {
      display: flex; align-items: center; gap: 12px;
      padding: 12px 14px;
      background: var(--surface-2);
      border-radius: var(--radius-sm);
      transition: all 0.2s;
    }
    .shopping-item.clickable {
      cursor: pointer;
    }
    .shopping-item.clickable:hover {
      background: var(--surface-3);
      transform: translateX(4px);
    }
    .shopping-info-btn {
      background: rgba(59,130,246,0.2);
      border: none;
      border-radius: 8px;
      padding: 6px 10px;
      cursor: pointer;
      font-size: 14px;
      margin-left: auto;
      transition: all 0.2s;
    }
    .shopping-info-btn:hover {
      background: rgba(59,130,246,0.4);
      transform: scale(1.1);
    }
    .shopping-icon {
      font-size: 24px;
      width: 40px; height: 40px;
      display: flex; align-items: center; justify-content: center;
      flex-shrink: 0;
      background: rgba(255,255,255,0.05);
      border-radius: 10px;
    }
    .shopping-info { flex: 1; }
    .shopping-name { font-size: 14px; font-weight: 500; margin-bottom: 2px; }
    .shopping-desc { font-size: 12px; color: var(--text-secondary); }
    .shopping-tip {
      margin-top: 16px; padding: 14px 16px;
      background: linear-gradient(135deg, rgba(255, 214, 10, 0.1), rgba(255, 149, 0, 0.1));
      border: 1px solid rgba(255, 214, 10, 0.2);
      border-radius: var(--radius-sm);
      font-size: 13px; color: var(--text-secondary);
    }
    .shopping-tip strong { color: var(--warning); }

    /* Modal Styles */
    .modal-overlay {
      position: fixed; top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(0, 0, 0, 0.85);
      backdrop-filter: blur(10px);
      z-index: 1000;
      display: flex; align-items: center; justify-content: center;
      padding: 24px;
      opacity: 0; visibility: hidden;
      transition: all 0.3s ease;
    }
    .modal-overlay.active { opacity: 1; visibility: visible; }

    .modal {
      background: var(--surface);
      border-radius: 20px;
      max-width: 600px; width: 100%;
      max-height: 90vh;
      overflow: hidden;
      transform: scale(0.9) translateY(20px);
      transition: transform 0.3s ease;
    }
    .modal-overlay.active .modal { transform: scale(1) translateY(0); }

    .modal-header {
      position: relative;
      height: 200px;
      overflow: hidden;
    }
    .modal-image {
      width: 100%; height: 100%;
      object-fit: cover;
    }
    .modal-close {
      position: absolute; top: 16px; right: 16px;
      width: 36px; height: 36px;
      background: rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(10px);
      border: none; border-radius: 50%;
      color: white; font-size: 20px;
      cursor: pointer;
      display: flex; align-items: center; justify-content: center;
      transition: background 0.2s;
    }
    .modal-close:hover { background: var(--danger); }

    .modal-icon-badge {
      position: absolute; bottom: -24px; left: 24px;
      width: 56px; height: 56px;
      background: var(--surface);
      border-radius: 16px;
      display: flex; align-items: center; justify-content: center;
      font-size: 28px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
    }

    .modal-body {
      padding: 40px 24px 24px;
      max-height: calc(90vh - 200px);
      overflow-y: auto;
    }

    .modal-title {
      font-size: 24px; font-weight: 700;
      margin-bottom: 8px;
    }
    .modal-location {
      font-size: 14px; color: var(--text-secondary);
      margin-bottom: 16px;
      display: flex; align-items: center; gap: 6px;
    }

    .modal-description {
      font-size: 15px; line-height: 1.7;
      color: var(--text-secondary);
      margin-bottom: 20px;
    }

    .modal-tips {
      background: var(--surface-2);
      border-radius: var(--radius-sm);
      padding: 16px;
      margin-bottom: 20px;
    }
    .modal-tips-title {
      font-size: 13px; font-weight: 600;
      color: var(--warning);
      margin-bottom: 8px;
      display: flex; align-items: center; gap: 6px;
    }
    .modal-tips-list {
      font-size: 13px; color: var(--text-secondary);
      padding-left: 16px;
    }
    .modal-tips-list li { margin-bottom: 4px; }

    .modal-video-btn {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 12px;
      width: 100%;
      padding: 16px 24px;
      background: linear-gradient(135deg, #ff0000, #cc0000);
      border: none;
      border-radius: var(--radius-sm);
      color: white;
      font-family: inherit;
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
      margin-bottom: 20px;
      transition: all 0.2s;
    }
    .modal-video-btn:hover {
      transform: scale(1.02);
      box-shadow: 0 4px 20px rgba(255, 0, 0, 0.3);
    }
    .modal-video-btn svg {
      width: 24px;
      height: 24px;
    }

    .modal-buttons {
      display: flex;
      gap: 12px;
      margin-bottom: 16px;
    }
    .modal-buttons .modal-video-btn {
      flex: 1;
      margin-bottom: 0;
    }
    .modal-map-btn {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      flex: 1;
      padding: 16px 24px;
      background: linear-gradient(135deg, #4285f4, #34a853);
      border: none;
      border-radius: var(--radius-sm);
      color: white;
      font-family: inherit;
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
    }
    .modal-map-btn:hover {
      transform: scale(1.02);
      box-shadow: 0 4px 20px rgba(66, 133, 244, 0.3);
    }
    .modal-map-btn svg {
      width: 20px;
      height: 20px;
    }

    /* Timeline Styles */
    .timeline-card {
      background: linear-gradient(180deg, rgba(244,114,182,0.08) 0%, var(--card) 20%);
    }
    .timeline-badge {
      background: linear-gradient(135deg, #f472b6, #c084fc) !important;
      font-size: 11px !important;
    }
    .timeline-intro {
      text-align: center;
      font-size: 16px;
      color: var(--text-secondary);
      padding: 0 24px 20px;
      margin: 0;
    }
    .timeline-container {
      padding: 0 16px 24px;
    }
    .timeline-day {
      position: relative;
      margin-bottom: 16px;
      border-radius: 16px;
      overflow: hidden;
      background: var(--surface-2);
      border: 1px solid var(--border);
      transition: all 0.3s;
    }
    .timeline-day:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(0,0,0,0.2);
    }
    .timeline-day.expanded .day-content {
      max-height: 1000px;
      padding: 16px;
    }
    .day-header {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 16px;
      cursor: pointer;
      background: linear-gradient(135deg, var(--surface-3), var(--surface-2));
    }
    .day-number {
      width: 48px;
      height: 48px;
      border-radius: 12px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      color: white;
      flex-shrink: 0;
    }
    .day-number .num { font-size: 20px; line-height: 1; }
    .day-number .label { font-size: 10px; opacity: 0.9; }
    .day-number.osaka { background: linear-gradient(135deg, #f97316, #ea580c); }
    .day-number.kyoto { background: linear-gradient(135deg, #a855f7, #7c3aed); }
    .day-number.nara { background: linear-gradient(135deg, #22c55e, #16a34a); }
    .day-number.tokyo { background: linear-gradient(135deg, #3b82f6, #2563eb); }
    .day-info {
      flex: 1;
      min-width: 0;
    }
    .day-title {
      font-size: 16px;
      font-weight: 600;
      margin-bottom: 4px;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .day-subtitle {
      font-size: 13px;
      color: var(--text-dim);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .day-toggle {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background: rgba(255,255,255,0.1);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 14px;
      transition: transform 0.3s;
    }
    .timeline-day.expanded .day-toggle {
      transform: rotate(180deg);
    }
    .day-content {
      max-height: 0;
      overflow: hidden;
      padding: 0 16px;
      transition: all 0.3s ease;
    }
    .activity-block {
      display: flex;
      gap: 12px;
      padding: 12px 0;
      border-bottom: 1px dashed rgba(255,255,255,0.1);
    }
    .activity-block:last-child {
      border-bottom: none;
    }
    .activity-time {
      width: 50px;
      font-size: 11px;
      font-weight: 600;
      color: var(--text-dim);
      text-align: center;
      padding-top: 4px;
    }
    .activity-dot {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      flex-shrink: 0;
      margin-top: 4px;
    }
    .activity-dot.food { background: #f97316; }
    .activity-dot.activity { background: #3b82f6; }
    .activity-dot.travel { background: #22c55e; }
    .activity-dot.sleep { background: #a855f7; }
    .activity-dot.photo { background: #ec4899; }
    .activity-details {
      flex: 1;
    }
    .activity-name {
      font-weight: 600;
      font-size: 14px;
      margin-bottom: 4px;
      display: flex;
      align-items: center;
      gap: 6px;
    }
    .activity-desc {
      font-size: 12px;
      color: var(--text-dim);
      line-height: 1.5;
    }
    .activity-tip {
      margin-top: 6px;
      padding: 8px 10px;
      background: rgba(34,197,94,0.1);
      border-radius: 8px;
      font-size: 11px;
      color: #22c55e;
      display: flex;
      align-items: flex-start;
      gap: 6px;
    }
    .activity-tip::before {
      content: 'üí°';
      flex-shrink: 0;
    }
    .highlight-box {
      margin-top: 12px;
      padding: 12px;
      background: linear-gradient(135deg, rgba(59,130,246,0.15), rgba(168,85,247,0.1));
      border-radius: 10px;
      border-left: 3px solid #3b82f6;
    }
    .highlight-title {
      font-weight: 600;
      font-size: 13px;
      margin-bottom: 6px;
      display: flex;
      align-items: center;
      gap: 6px;
    }
    .highlight-text {
      font-size: 12px;
      color: var(--text-dim);
    }
    .food-items {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-top: 8px;
    }
    .food-tag {
      padding: 4px 10px;
      background: rgba(249,115,22,0.15);
      border-radius: 20px;
      font-size: 12px;
      color: #f97316;
    }
    .timeline-legend {
      display: flex;
      justify-content: center;
      gap: 16px;
      padding: 16px;
      border-top: 1px solid var(--border);
      flex-wrap: wrap;
    }
    .legend-item {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 12px;
      color: var(--text-dim);
    }
    .legend-dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
    }
    .legend-dot.food { background: #f97316; }
    .legend-dot.activity { background: #3b82f6; }
    .legend-dot.travel { background: #22c55e; }
    .legend-dot.sleep { background: #a855f7; }
    
    /* Travel indicator */
    .travel-indicator {
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 12px;
      margin: 8px 0;
      background: linear-gradient(90deg, transparent, rgba(34,197,94,0.1), transparent);
    }
    .travel-badge {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 8px 16px;
      background: rgba(34,197,94,0.15);
      border-radius: 20px;
      font-size: 13px;
      color: #22c55e;
      font-weight: 500;
    }

    .modal-footer {
      display: flex; gap: 12px;
      padding-top: 16px;
      border-top: 1px solid var(--border);
    }
    .modal-price {
      flex: 1;
      font-size: 24px; font-weight: 700;
      color: var(--accent);
    }
    .modal-price-note { font-size: 12px; color: var(--text-secondary); font-weight: 400; }

    .modal-btn {
      padding: 14px 28px;
      background: linear-gradient(135deg, var(--accent), var(--accent-2));
      border: none; border-radius: var(--radius-sm);
      color: white; font-size: 15px; font-weight: 600;
      cursor: pointer; transition: all 0.2s;
    }
    .modal-btn:hover { transform: scale(1.02); }
    .modal-btn.added { background: var(--success); }

    ::-webkit-scrollbar { width: 8px; }
    ::-webkit-scrollbar-track { background: transparent; }
    ::-webkit-scrollbar-thumb { background: var(--surface-3); border-radius: 4px; }
  </style>
</head>
<body>
  <header class="header">
    <div class="header-icon">üóæ</div>
    <h1>Japonya Seyahat Planlayƒ±cƒ±</h1>
    <p>Hayalindeki Japonya gezisi i√ßin b√ºt√ßeni planla, aktivitelerini se√ß!</p>
  </header>

  <main class="container">
    <div class="illustration">
      <span class="illustration-item">üå∏</span>
      <span class="illustration-item">‚õ©Ô∏è</span>
      <span class="illustration-item">üèØ</span>
      <span class="illustration-item">üç£</span>
      <span class="illustration-item">üóª</span>
    </div>

    <!-- Trip Details -->
    <section class="card">
      <div class="card-header">
        <div class="card-header-icon">‚úàÔ∏è</div>
        <h2>Seyahat Detaylarƒ±</h2>
        </div>
      <div class="card-body">
        <div class="input-row">
          <div class="input-row-left">
            <div class="input-icon">üìÖ</div>
            <div><div class="input-label">Seyahat Tarihi</div><div class="input-sublabel">Ne zaman gideceksin?</div></div>
        </div>
          <input type="date" id="tripDate" />
        </div>
        <div class="input-row">
          <div class="input-row-left">
            <div class="input-icon">üåô</div>
            <div><div class="input-label">Ka√ß G√ºn Kalacaksƒ±n?</div><div class="input-sublabel">Toplam g√ºn sayƒ±sƒ±</div></div>
        </div>
          <div class="stepper">
            <button class="stepper-btn" onclick="adjustValue('days', -1)">‚àí</button>
            <span class="stepper-value" id="daysDisplay">8</span>
            <button class="stepper-btn" onclick="adjustValue('days', 1)">+</button>
          </div>
          <input type="hidden" id="days" value="8" />
        </div>
      </div>
      <div class="card-header" style="border-top: 1px solid var(--border);">
        <div class="card-header-icon">üë•</div>
        <h2>Ka√ß Ki≈üi Gidecek?</h2>
      </div>
      <div class="person-cards">
        <div class="person-card">
          <div class="person-card-icon">üßë</div>
          <div class="person-card-label">Yeti≈ükin</div>
          <div class="stepper" style="justify-content: center;">
            <button class="stepper-btn" onclick="adjustValue('adults', -1)">‚àí</button>
            <span class="stepper-value" id="adultsDisplay">2</span>
            <button class="stepper-btn" onclick="adjustValue('adults', 1)">+</button>
          </div>
          <input type="hidden" id="adults" value="2" />
        </div>
        <div class="person-card">
          <div class="person-card-icon">üëß</div>
          <div class="person-card-label">√áocuk</div>
          <div class="stepper" style="justify-content: center;">
            <button class="stepper-btn" onclick="adjustValue('children', -1)">‚àí</button>
            <span class="stepper-value" id="childrenDisplay">1</span>
            <button class="stepper-btn" onclick="adjustValue('children', 1)">+</button>
          </div>
          <input type="hidden" id="children" value="1" />
        </div>
      </div>
      <div class="notice">
        <span class="notice-icon">üí≥</span>
        <span class="notice-text">U√ßak biletleri kredi kartƒ± ile √∂denecek, nakit b√ºt√ßeye dahil deƒüil.</span>
      </div>
    </section>

    <!-- Budget Card -->
    <section class="card">
      <div class="card-header">
        <div class="card-header-icon">üí∞</div>
        <h2>B√ºt√ße Bilgileri</h2>
        </div>
      <div class="card-body">
        <div class="input-row">
          <div class="input-row-left">
            <div class="input-icon">üè¶</div>
            <div><div class="input-label">Mevcut Birikim</div><div class="input-sublabel">≈ûu an ne kadar paran var?</div></div>
        </div>
          <input type="number" id="savings" min="0" step="1000" placeholder="100.000" />
        </div>
        <div class="input-row">
          <div class="input-row-left">
            <div class="input-icon">üè®</div>
            <div><div class="input-label">Konaklama</div><div class="input-sublabel">Gece ba≈üƒ± (oda fiyatƒ±)</div></div>
          </div>
          <input type="number" id="nightly" min="0" step="100" placeholder="6.000" />
        </div>
        <div class="input-row">
          <div class="input-row-left">
            <div class="input-icon">üçú</div>
            <div><div class="input-label">G√ºnl√ºk Harcama</div><div class="input-sublabel">Yeme-i√ßme + ula≈üƒ±m (ki≈üi ba≈üƒ±)</div></div>
          </div>
          <input type="number" id="daily" min="0" step="100" placeholder="2.500" />
        </div>
        <div class="input-row">
          <div class="input-row-left">
            <div class="input-icon">üõçÔ∏è</div>
            <div><div class="input-label">Alƒ±≈üveri≈ü / Elektronik</div><div class="input-sublabel">Toplam alƒ±≈üveri≈ü b√ºt√ßesi</div></div>
          </div>
          <input type="number" id="electronics" min="0" step="1000" placeholder="30.000" />
        </div>
        <div class="input-row">
          <div class="input-row-left">
            <div class="input-icon">üìã</div>
            <div><div class="input-label">Sabit Giderler</div><div class="input-sublabel">Vize, sigorta, SIM kart vb.</div></div>
          </div>
          <input type="number" id="fixed" min="0" step="100" placeholder="15.000" />
        </div>
        <div class="input-row">
          <div class="input-row-left">
            <div class="input-icon">üõ°Ô∏è</div>
            <div><div class="input-label">G√ºvenlik Payƒ±</div><div class="input-sublabel">Ekstra buffer (%)</div></div>
          </div>
          <input type="number" id="bufferPct" min="0" max="50" step="1" placeholder="10" />
        </div>
      </div>
      <div class="button-row">
        <button class="btn btn-primary" id="saveBtn">üíæ Kaydet</button>
        <button class="btn btn-secondary" id="resetBtn">Sƒ±fƒ±rla</button>
      </div>
    </section>

    <!-- Trip Timeline -->
    <section class="card timeline-card">
      <div class="card-header">
        <div class="card-header-icon">üóæ</div>
        <h2>9 G√ºnl√ºk Macera Planƒ±</h2>
        <span class="card-header-badge timeline-badge">üöÇ Osaka ‚Üí Kyoto ‚Üí Tokyo</span>
      </div>
      <p class="timeline-intro">üéí Hazƒ±r mƒ±sƒ±n? ƒ∞≈üte seni bekleyen harika macera!</p>
      
      <div class="timeline-container" id="tripTimeline"></div>
      
      <div class="timeline-legend">
        <div class="legend-item"><span class="legend-dot food"></span> Yemek</div>
        <div class="legend-item"><span class="legend-dot activity"></span> Aktivite</div>
        <div class="legend-item"><span class="legend-dot travel"></span> Yolculuk</div>
        <div class="legend-item"><span class="legend-dot sleep"></span> Dinlenme</div>
      </div>
    </section>

    <!-- Activities Checklist -->
    <section class="card">
      <div class="card-header">
        <div class="card-header-icon">üéØ</div>
        <h2>Yapƒ±lacaklar & Aktiviteler</h2>
        <span class="card-header-badge" id="activitiesCount">0 se√ßili</span>
        </div>
      <div id="activityList"></div>
      <div class="activities-total">
        <span class="activities-total-label">Se√ßilen Aktiviteler Toplamƒ±</span>
        <span class="activities-total-value" id="activitiesTotal">0 ‚Ç∫</span>
        </div>
      <div class="map-button-container">
        <button class="map-button" id="showMapBtn" onclick="showOnMap()">
          <svg viewBox="0 0 24 24" fill="currentColor" width="20" height="20">
            <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/>
          </svg>
          üó∫Ô∏è Se√ßilenleri Haritada G√∂ster
        </button>
        <span class="map-button-hint" id="mapHint">Aktivite se√ßin</span>
      </div>
    </section>

    <!-- Trip Advisor - Konaklama Planƒ± -->
    <section class="card trip-advisor-card">
      <div class="card-header">
        <div class="card-header-icon">üè®</div>
        <h2>Akƒ±llƒ± Konaklama Planƒ±</h2>
      </div>
      <p class="trip-advisor-intro">Se√ßtiƒüiniz aktivitelere g√∂re √∂nerilen konaklama planƒ±:</p>
      
      <div id="cityBreakdown" class="city-breakdown">
        <div class="no-selection-msg">
          <span class="no-selection-icon">üéØ</span>
          <p>Aktivite se√ßerek konaklama planƒ±nƒ±zƒ± olu≈üturun</p>
        </div>
      </div>
      
      <div class="hotel-pricing-info">
        <div class="pricing-header">
          <span class="pricing-icon">üí∞</span>
          <span>Ortalama Otel Fiyatlarƒ± (Gecelik)</span>
        </div>
        <div class="pricing-grid">
          <div class="price-card budget">
            <div class="price-label">B√ºt√ße</div>
            <div class="price-range">‚Ç∫800 - ‚Ç∫1,500</div>
            <div class="price-desc">Hostel, Capsule Otel</div>
          </div>
          <div class="price-card midrange">
            <div class="price-label">Orta</div>
            <div class="price-range">‚Ç∫1,500 - ‚Ç∫3,000</div>
            <div class="price-desc">3‚òÖ Otel, Business Hotel</div>
          </div>
          <div class="price-card premium">
            <div class="price-label">Premium</div>
            <div class="price-range">‚Ç∫3,000 - ‚Ç∫6,000</div>
            <div class="price-desc">4‚òÖ-5‚òÖ Otel, Ryokan</div>
          </div>
        </div>
      </div>
      
      <div class="trip-summary" id="tripSummary" style="display: none;">
        <div class="summary-header">
          <span>üìã</span> Gezi √ñzeti
        </div>
        <div class="summary-content" id="tripSummaryContent"></div>
      </div>
    </section>

    <!-- Shopping Guide -->
    <section class="card">
      <div class="card-header">
        <div class="card-header-icon">üõí</div>
        <h2>√ñnemli Alƒ±≈üveri≈ü Merkezleri</h2>
      </div>
      <div class="shopping-guide" id="shoppingList"></div>
      <div class="shopping-tip">
        üí° <strong>Tax-Free ƒ∞pucu:</strong> 5.000¬• √ºzeri alƒ±≈üveri≈ülerde pasaport g√∂stererek %10 vergi iadesi alabilirsiniz!
      </div>
    </section>

    <!-- Progress Card -->
    <section class="card">
      <div class="card-header">
        <div class="card-header-icon">üìä</div>
        <h2>ƒ∞lerleme Durumu</h2>
      </div>
      <div class="progress-section">
        <div class="progress-circle-container">
          <svg class="progress-circle" width="180" height="180" viewBox="0 0 180 180">
            <defs>
              <linearGradient id="progressGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" style="stop-color:#ff6b9d" />
                <stop offset="100%" style="stop-color:#c084fc" />
              </linearGradient>
            </defs>
            <circle class="progress-circle-bg" cx="90" cy="90" r="80" />
            <circle class="progress-circle-fill" id="progressCircle" cx="90" cy="90" r="80" />
          </svg>
          <div class="progress-text">
            <div class="progress-percent" id="progressPercent">0%</div>
            <div class="progress-label">tamamlandƒ±</div>
        </div>
      </div>
        <div class="progress-message" id="progressMessage">Verilerini girerek ba≈üla</div>
      </div>
      <div class="countdown">
        <div class="countdown-item">
          <div class="countdown-value" id="countdownDays">‚Äî</div>
          <div class="countdown-label">G√ºn</div>
        </div>
        <div class="countdown-item">
          <div class="countdown-value" id="countdownWeeks">‚Äî</div>
          <div class="countdown-label">Hafta</div>
        </div>
        <div class="countdown-item">
          <div class="countdown-value" id="countdownMonths">‚Äî</div>
          <div class="countdown-label">Ay</div>
        </div>
      </div>
      <div class="stats-grid">
        <div class="stat-box">
          <div class="stat-label">Hedef B√ºt√ße</div>
          <div class="stat-value" id="statTarget">‚Äî</div>
        </div>
        <div class="stat-box">
          <div class="stat-label">Mevcut Birikim</div>
          <div class="stat-value" id="statSavings">‚Äî</div>
        </div>
        <div class="stat-box">
          <div class="stat-label">Eksik / Fazla</div>
          <div class="stat-value" id="statGap">‚Äî</div>
        </div>
        <div class="stat-box">
          <div class="stat-label">Kalƒ±≈ü S√ºresi</div>
          <div class="stat-value" id="statStay">‚Äî</div>
        </div>
      </div>
      <div class="savings-row">
        <div class="savings-box">
          <div class="savings-label">üìÜ Haftalƒ±k Biriktirmen Gereken</div>
          <div class="savings-value" id="weeklySavings">‚Äî</div>
        </div>
        <div class="savings-box">
          <div class="savings-label">üìÖ Aylƒ±k Biriktirmen Gereken</div>
          <div class="savings-value" id="monthlySavings">‚Äî</div>
        </div>
      </div>
    </section>

    <!-- Analysis Card -->
    <section class="card">
      <div class="card-header">
        <div class="card-header-icon">‚úÖ</div>
        <h2>Durum Analizi</h2>
      </div>
      <div class="info-list" id="analysisList"></div>
    </section>
  </main>

  <footer class="footer">
    <p>üå∏ Hayalindeki Japonya seyahatine bir adƒ±m daha yakla≈ü!</p>
  </footer>

  <!-- Modal -->
  <div class="modal-overlay" id="modalOverlay">
    <div class="modal">
      <div class="modal-header">
        <img class="modal-image" id="modalImage" src="" alt="" />
        <button class="modal-close" onclick="closeModal()">√ó</button>
        <div class="modal-icon-badge" id="modalIcon"></div>
      </div>
      <div class="modal-body">
        <h2 class="modal-title" id="modalTitle"></h2>
        <div class="modal-location" id="modalLocation">üìç <span></span></div>
        <p class="modal-description" id="modalDesc"></p>
        <div class="modal-tips" id="modalTips"></div>
        <div class="modal-buttons">
          <button class="modal-video-btn" id="modalYoutubeBtn">
            <svg viewBox="0 0 24 24" fill="currentColor"><path d="M19.615 3.184c-3.604-.246-11.631-.245-15.23 0-3.897.266-4.356 2.62-4.385 8.816.029 6.185.484 8.549 4.385 8.816 3.6.245 11.626.246 15.23 0 3.897-.266 4.356-2.62 4.385-8.816-.029-6.185-.484-8.549-4.385-8.816zm-10.615 12.816v-8l8 3.993-8 4.007z"/></svg>
            YouTube'da ƒ∞zle
          </button>
          <button class="modal-map-btn" id="modalMapBtn">
            <svg viewBox="0 0 24 24" fill="currentColor" width="18" height="18"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/></svg>
            Haritada G√∂ster
          </button>
        </div>
        <div class="modal-footer" id="modalBtnContainer">
          <div class="modal-price">
            <span id="modalPrice"></span>
            <div class="modal-price-note" id="modalPriceNote"></div>
          </div>
          <button class="modal-btn" id="modalBtn" onclick="toggleFromModal()">Listeye Ekle</button>
        </div>
      </div>
    </div>
  </div>

<script>
  // --- Helpers (En ba≈üta tanƒ±mlanmalƒ±) ---
  const fmt = (n) => !isFinite(n) ? "‚Äî" : new Intl.NumberFormat("tr-TR", { maximumFractionDigits: 0 }).format(Math.round(n)) + " ‚Ç∫";
  const clamp = (v, a, b) => Math.min(b, Math.max(a, v));
  const byId = (id) => document.getElementById(id);

  // --- Aktiviteler Veritabanƒ± (Detaylƒ±) ---
  const ACTIVITIES = [
    // üé¢ TEMA PARKLARI
    {
      id: 'usj', icon: 'üßô', name: 'Universal Studios Japan',
      location: 'Osaka', price: 2100, perPerson: true, category: 'theme',
      lat: 34.6654, lng: 135.4323,
      image: 'https://images.unsplash.com/photo-1565618754154-c8011e5df2a6?w=800',
      description: 'Osaka\'nƒ±n en pop√ºler tema parkƒ±! Harry Potter\'ƒ±n B√ºy√ºl√º D√ºnyasƒ±, Super Nintendo World, Minions Park ve daha fazlasƒ± sizi bekliyor. Hogwarts Kalesi\'nde b√ºy√º yapƒ±n, Mario Kart\'ta yarƒ±≈üƒ±n!',
      tips: ['Hafta i√ßi gidin, hafta sonu √ßok kalabalƒ±k', 'Express Pass alarak kuyruklarƒ± atlayƒ±n', 'Super Nintendo World i√ßin sabah erkenden giri≈ü yapƒ±n', 'Butterbeer denemeden d√∂nmeyin!'],
      youtube: 'dXc-UxdEjbs'
    },
    {
      id: 'nintendo', icon: 'üçÑ', name: 'Super Nintendo World',
      location: 'Osaka - USJ i√ßinde', price: 0, perPerson: true, category: 'theme',
      lat: 34.6660, lng: 135.4318,
      image: 'https://images.unsplash.com/photo-1566577739112-5180d4bf9390?w=800',
      description: 'Mario\'nun d√ºnyasƒ±na adƒ±m atƒ±n! Ger√ßek boyutlu Mushroom Kingdom, interaktif Power-Up Band ile oyunlar, Mario Kart: Koopa\'s Challenge ve Yoshi\'s Adventure sizleri bekliyor.',
      tips: ['USJ biletine dahil, ekstra √ºcret yok', 'Power-Up Band (bileklik) ayrƒ± satƒ±n alƒ±nƒ±r', 'Toad\'s Cafe\'de Mario temalƒ± yemekler var', 'Sabah parkla birlikte a√ßƒ±lƒ±yor, erken gidin'],
      youtube: 'fG-ZaWarDKA'
    },
    {
      id: 'disney', icon: 'üè∞', name: 'Tokyo Disneyland',
      location: 'Tokyo - Maihama', price: 2300, perPerson: true, category: 'theme',
      lat: 35.6329, lng: 139.8804,
      image: 'https://images.unsplash.com/photo-1624601573012-efb68931cc8f?w=800',
      description: 'Japonya\'nƒ±n en b√ºy√ºl√º yeri! Cinderella Kalesi, Space Mountain, Splash Mountain ve sayƒ±sƒ±z g√∂steriler. D√ºnyaca √ºnl√º Disney hospitalitysi ile unutulmaz anƒ±lar biriktirin.',
      tips: ['Gece ge√ßit t√∂reni (Electrical Parade) mutlaka izleyin', 'Popcorn kovalarƒ± koleksiyon i√ßin harika', 'Premier Access ile pop√ºler oyunlara √∂ncelik alƒ±n', 'Hafta ortasƒ± daha az kalabalƒ±k'],
      youtube: 'UPi6Xw_zHJI'
    },
    {
      id: 'disneysea', icon: 'üö¢', name: 'Tokyo DisneySea',
      location: 'Tokyo - Maihama', price: 2300, perPerson: true, category: 'theme',
      lat: 35.6267, lng: 139.8850,
      image: 'https://images.unsplash.com/photo-1545893835-abaa50cbe628?w=800',
      description: 'D√ºnyada tek! Deniz temalƒ± bu park, yeti≈ükinler i√ßin m√ºkemmel. Mediterrean Harbor, Mysterious Island, Mermaid Lagoon. Journey to the Center of the Earth efsanevi!',
      tips: ['Disneyland\'den daha yeti≈ükin odaklƒ±', 'Tower of Terror harika!', 'Ak≈üam Mediterrean Harbor\'da ≈üarap tadƒ±mƒ± yapƒ±labilir', 'Fantasy Springs yeni a√ßƒ±ldƒ±, ka√ßƒ±rmayƒ±n!'],
      youtube: 'WVS2p3d6GFI'
    },
    {
      id: 'teamlab', icon: 'üí´', name: 'teamLab Borderless',
      location: 'Tokyo - Azabudai Hills', price: 900, perPerson: true, category: 'theme',
      lat: 35.6609, lng: 139.7414,
      image: 'https://images.unsplash.com/photo-1549887534-1541e9326642?w=800',
      description: 'Dijital sanatƒ±n sƒ±nƒ±rsƒ±z d√ºnyasƒ±! Duvarsƒ±z, sƒ±nƒ±rsƒ±z bir m√ºze. I≈üƒ±k, renk ve hareket i√ßinde kaybolun. √ái√ßekler √ºzerinizden akƒ±yor, balƒ±klar etrafƒ±nƒ±zda y√ºz√ºyor.',
      tips: ['Beyaz kƒ±yafet giyin, renkler √ºzerinize yansƒ±r', 'Online bilet mutlaka √∂nceden alƒ±n', 'En az 2-3 saat ayƒ±rƒ±n', 'Fotoƒüraf √ßekmek serbest ve harika sonu√ßlar √ßƒ±kƒ±yor'],
      youtube: 'IwLSrNu1ppI'
    },
    {
      id: 'ghibli', icon: 'üê±', name: 'Ghibli M√ºzesi',
      location: 'Tokyo - Mitaka', price: 250, perPerson: true, category: 'theme',
      lat: 35.6962, lng: 139.5704,
      image: 'https://images.unsplash.com/photo-1536098561742-ca998e48cbcc?w=800',
      description: 'Hayao Miyazaki\'nin b√ºy√ºl√º d√ºnyasƒ±! Totoro, Spirited Away, Howl\'s Moving Castle... Animasyon st√ºdyosu atmosferinde orijinal √ßizimler, dev Robot Soldier ve √∂zel kƒ±sa filmler.',
      tips: ['Biletler 1 ay √∂nceden satƒ±≈üa √ßƒ±kar, hemen t√ºkenir', 'Lawson\'dan veya resmi siteden alƒ±n', 'ƒ∞√ßeride fotoƒüraf √ßekmek yasak', '√áatƒ±daki Robot Soldier ka√ßƒ±rƒ±lmaz'],
      youtube: '1QG6xOCgtjY'
    },

    // ‚õ©Ô∏è TAPINAKLAR
    {
      id: 'fushimi', icon: '‚õ©Ô∏è', name: 'Fushimi Inari Tapƒ±naƒüƒ±',
      location: 'Kyoto', price: 0, perPerson: false, category: 'temple',
      lat: 34.9671, lng: 135.7727,
      image: 'https://images.unsplash.com/photo-1478436127897-769e1b3f0f36?w=800',
      description: '10.000 kƒ±rmƒ±zƒ± torii kapƒ±sƒ±! Daƒüƒ±n tepesine kadar uzanan bu mistik yol, Japonya\'nƒ±n en ikonik g√∂r√ºnt√ºs√º. ƒ∞nari tilki tanrƒ±sƒ±na adanmƒ±≈ü bu tapƒ±nak 24 saat a√ßƒ±k ve √ºcretsiz.',
      tips: ['G√ºn doƒüumunda gidin, turist yok', 'Tepeye y√ºr√ºy√º≈ü 2-3 saat s√ºr√ºyor', 'Yarƒ±da inari sushi (tofu) deneyin', 'Gece de a√ßƒ±k ve √ßok atmosferik'],
      youtube: 'FmRyJ-RtBPg'
    },
    {
      id: 'kinkakuji', icon: 'üèØ', name: 'Kinkaku-ji (Altƒ±n Tapƒ±nak)',
      location: 'Kyoto', price: 120, perPerson: true, category: 'temple',
      lat: 35.0394, lng: 135.7292,
      image: 'https://images.unsplash.com/photo-1493976040374-85c8e12f0c0e?w=800',
      description: 'Altƒ±n yapraklarla kaplƒ± ikonik Zen tapƒ±naƒüƒ±! G√∂let √ºzerindeki yansƒ±masƒ± efsanevi. UNESCO D√ºnya Mirasƒ± listesinde. Her mevsim farklƒ± g√ºzellikte.',
      tips: ['Sabah 9\'da a√ßƒ±lƒ±≈üta gidin', 'Sonbaharda kƒ±rmƒ±zƒ± yapraklarla muhte≈üem', 'Bah√ßede matcha ve tatlƒ± var', 'Yakƒ±ndaki Ryoan-ji zen bah√ßesini de g√∂r√ºn'],
      youtube: 'V6h77ziYmIE'
    },
    {
      id: 'sensoji', icon: 'üèÆ', name: 'Senso-ji Tapƒ±naƒüƒ±',
      location: 'Tokyo - Asakusa', price: 0, perPerson: false, category: 'temple',
      lat: 35.7148, lng: 139.7967,
      image: 'https://images.unsplash.com/photo-1545569341-9eb8b30979d9?w=800',
      description: 'Tokyo\'nun en eski tapƒ±naƒüƒ± (645 yƒ±lƒ±ndan beri)! Dev kƒ±rmƒ±zƒ± fener (Kaminarimon), Nakamise alƒ±≈üveri≈ü sokaƒüƒ±, t√ºts√º dumanlarƒ±... Asakusa\'nƒ±n kalbi.',
      tips: ['Sabah erken saatler bo≈ü ve huzurlu', 'Nakamise\'de ningyo-yaki ve senbei alƒ±n', 'Omikuji (kaƒüƒ±t fal) √ßekin', 'Ak≈üam aydƒ±nlatmasƒ± √ßok g√ºzel'],
      youtube: 'fFLVheK5_C4'
    },
    {
      id: 'meiji', icon: 'üå≥', name: 'Meiji Jingu',
      location: 'Tokyo - Harajuku', price: 0, perPerson: false, category: 'temple',
      lat: 35.6764, lng: 139.6993,
      image: 'https://images.unsplash.com/photo-1583400417478-c14b0d0a6dc8?w=800',
      description: 'Dev torii kapƒ±sƒ±ndan ge√ßip ormanƒ±n i√ßine dalƒ±n! ƒ∞mparator Meiji\'ye adanmƒ±≈ü bu t√ºrbe, Tokyo\'nun tam ortasƒ±nda doƒüal bir vaha. Pazar g√ºnleri d√ºƒü√ºnler g√∂rebilirsiniz.',
      tips: ['Harajuku\'dan y√ºr√ºyerek 10 dk', 'Dilek tahtalarƒ±na yazƒ±n', 'ƒ∞ri torii kapƒ±sƒ± fotoƒüraf i√ßin m√ºkemmel', 'ƒ∞√ß bah√ße √ºcretli ama √ßok g√ºzel'],
      youtube: 'CQZLG0sQp8U'
    },
    {
      id: 'todaiji', icon: 'ü¶å', name: 'Todai-ji & Nara Parkƒ±',
      location: 'Nara', price: 150, perPerson: true, category: 'temple',
      lat: 34.6890, lng: 135.8398,
      image: 'https://images.unsplash.com/photo-1528360983277-13d401cdc186?w=800',
      description: 'D√ºnyanƒ±n en b√ºy√ºk bronz Buda heykeli ve onu koruyan devasa ah≈üap tapƒ±nak! Parkta 1.200+ serbest geyik dola≈üƒ±yor. Geyikler selam veriyor ve shika senbei (bisk√ºvi) yiyor!',
      tips: ['Geyik bisk√ºvisi (shika senbei) 200¬•', 'Geyikler eƒüilirseniz eƒüilerek selamlar', 'Yiyeceƒüinizi saklayƒ±n, geyikler a√ßg√∂zl√º!', 'Kyoto\'dan tren ile 45 dk'],
      youtube: 'u7-lA1WFBsc'
    },
    {
      id: 'arashiyama', icon: 'üéã', name: 'Arashiyama Bambu Ormanƒ±',
      location: 'Kyoto', price: 0, perPerson: false, category: 'temple',
      lat: 35.0094, lng: 135.6737,
      image: 'https://images.unsplash.com/photo-1504198453319-5ce911bafcde?w=800',
      description: 'Dev bambularƒ±n arasƒ±nda y√ºr√ºy√ºn! R√ºzgarda bambularƒ±n sesi meditasyon gibi. Tenryu-ji tapƒ±naƒüƒ±, Togetsukyo k√∂pr√ºs√º ve maymun parkƒ± aynƒ± b√∂lgede.',
      tips: ['Sabah 7\'de gidin, turist yok', 'Kimono kiralayƒ±p fotoƒüraf √ßekin', 'Yakƒ±ndaki Tenryu-ji bah√ßesi UNESCO mirasƒ±', 'Tekne turu i√ßin Hozu Nehri\'ne gidin'],
      youtube: 'uSGnLKm0ICA'
    },
    {
      id: 'himeji', icon: 'üèØ', name: 'Himeji Kalesi',
      location: 'Himeji', price: 250, perPerson: true, category: 'temple',
      lat: 34.8394, lng: 134.6939,
      image: 'https://images.unsplash.com/photo-1576675466969-38eeae4b41f6?w=800',
      description: 'Japonya\'nƒ±n en g√ºzel ve en iyi korunmu≈ü kalesi! "Beyaz Balƒ±k√ßƒ±l" lakaplƒ± bu UNESCO mirasƒ±, feodal Japonya\'nƒ±n ihti≈üamƒ±nƒ± g√∂zler √∂n√ºne seriyor.',
      tips: ['Shinkansen ile Osaka\'dan 30 dk', 'ƒ∞√ß kƒ±sƒ±mda merdiven √ßok, rahat ayakkabƒ±', 'Kiraz √ßi√ßeƒüi sezonunda muhte≈üem', 'Koko-en bah√ßesi hemen yanƒ±nda'],
      youtube: 'f7Z2KTxfYQU'
    },

    // üçú YEMEK DENEYƒ∞MLERƒ∞
    {
      id: 'tsukiji', icon: 'üêü', name: 'Tsukiji/Toyosu Balƒ±k Pazarƒ±',
      location: 'Tokyo', price: 750, perPerson: true, category: 'food',
      lat: 35.6654, lng: 139.7707,
      image: 'https://images.unsplash.com/photo-1580442151529-343f2f6e0e27?w=800',
      description: 'D√ºnyanƒ±n en b√ºy√ºk balƒ±k pazarƒ±! Toyosu\'da ton balƒ±ƒüƒ± m√ºzayedesi, Tsukiji Outer Market\'te taze sushi, sashimi, tamagoyaki. Sabah kahvaltƒ±sƒ± i√ßin m√ºkemmel.',
      tips: ['Ton m√ºzayedesi i√ßin 5:30\'da orada olun (kayƒ±t gerekli)', 'Tsukiji Outer Market 9-14 arasƒ± a√ßƒ±k', 'Sushi Dai veya Daiwa Sushi i√ßin kuyruk var', 'Tamagoyaki (Japon omleti) deneyin'],
      youtube: '5TGz5KrE3Bc'
    },
    {
      id: 'ramen', icon: 'üçú', name: 'Shin-Yokohama Ramen M√ºzesi',
      location: 'Yokohama', price: 100, perPerson: true, category: 'food',
      lat: 35.5066, lng: 139.6178,
      image: 'https://images.unsplash.com/photo-1569718212165-3a8278d5f624?w=800',
      description: '1958 Japonya\'sƒ±nƒ± yeniden ya≈üayƒ±n! Retro sokak atmosferinde 9 farklƒ± ramen d√ºkkanƒ±. Tokyo, Sapporo, Hakata, Kumamoto... T√ºm Japonya\'nƒ±n ramenleri bir arada.',
      tips: ['Mini boyut sipari≈ü edip birka√ß √ße≈üit deneyin', 'Tokyo\'dan 30 dk tren mesafesi', 'Giri≈üte sadece kapƒ± √ºcreti, ramen ayrƒ±', 'Cumartesi √ßok kalabalƒ±k'],
      youtube: 'KgHsMzT1k70'
    },
    {
      id: 'sake', icon: 'üç∂', name: 'Sake Tadƒ±m Turu',
      location: 'Kyoto - Fushimi', price: 400, perPerson: true, category: 'food',
      lat: 34.9293, lng: 135.7589,
      image: 'https://images.unsplash.com/photo-1516100882582-96c3a05fe590?w=800',
      description: 'Japonya\'nƒ±n en eski sake b√∂lgesi Fushimi! Gekkeikan ve Kizakura gibi tarihi sake evlerini gezin, √ºretimi √∂ƒürenin, onlarca √ße≈üit sake tadƒ±n.',
      tips: ['Gekkeikan Okura Sake Museum\'da tur + tadƒ±m', 'Kizakura Kappa Country\'de restoran da var', 'Fushimi Inari ile aynƒ± g√ºn yapƒ±labilir', 'Junmai Daiginjo en kaliteli √ße≈üit'],
      youtube: 'wg3MeCXkS40'
    },
    {
      id: 'sushicourse', icon: 'üç£', name: 'Sushi Yapƒ±m Kursu',
      location: 'Tokyo/Kyoto', price: 2000, perPerson: true, category: 'food',
      lat: 35.6654, lng: 139.7707,
      image: 'https://images.unsplash.com/photo-1579871494447-9811cf80d66c?w=800',
      description: 'Sushi ustasƒ±ndan nigiri, maki ve temaki yapmayƒ± √∂ƒürenin! Balƒ±k se√ßimi, pirin√ß hazƒ±rlama, kesim teknikleri... Yaptƒ±klarƒ±nƒ±zƒ± yiyerek bitirin!',
      tips: ['Airbnb Experiences\'ta kurslar var', 'Tsukiji yakƒ±nƒ±nda daha otantik', '2-3 saat s√ºr√ºyor', 'Vejetaryen se√ßenekler de mevcut'],
      youtube: 'joAbKdfqPP8'
    },
    {
      id: 'izakaya', icon: 'üçª', name: 'Izakaya Turu',
      location: 'Tokyo/Osaka', price: 1200, perPerson: true, category: 'food',
      lat: 35.6938, lng: 139.7034,
      image: 'https://images.unsplash.com/photo-1554502078-ef0fc409efce?w=800',
      description: 'Japon pub k√ºlt√ºr√ºn√º ya≈üayƒ±n! Yakitori, edamame, karaage ile bira ve sake. Yerel halkla omuz omuza Memory Lane (Omoide Yokocho) veya Shinsekai sokaklarƒ±nda.',
      tips: ['Shinjuku - Omoide Yokocho atmosferik', 'Osaka - Shinsekai daha yerel', 'Nomihoudai (sƒ±nƒ±rsƒ±z i√ßki) paketleri var', 'Yalnƒ±z da gidilebilir, bar k√ºlt√ºr√º g√º√ßl√º'],
      youtube: 'V5Gv56FYXdE'
    },

    // üé≠ K√úLT√úREL DENEYƒ∞MLER
    {
      id: 'kimono', icon: 'üëò', name: 'Kimono Kiralama',
      location: 'Kyoto/Tokyo', price: 1200, perPerson: true, category: 'culture',
      lat: 35.0036, lng: 135.7786,
      image: 'https://images.unsplash.com/photo-1528360983277-13d401cdc186?w=800',
      description: 'Geleneksel kimono giyip Kyoto sokaklarƒ±nda gezin! Profesyonel giydirme, sa√ß yapƒ±mƒ± ve aksesuar dahil. Fotoƒüraflarƒ±nƒ±z m√ºthi≈ü olacak.',
      tips: ['Yume Kyoto ve Okamoto pop√ºler d√ºkkanlar', 'Sabah erken randevu alƒ±n', 'Erkekler i√ßin de se√ßenekler var', 'Arashiyama veya Gion\'da y√ºr√ºy√ºn'],
      youtube: 'C5L1_gnHrmc'
    },
    {
      id: 'tea', icon: 'üçµ', name: '√áay Seremonisi',
      location: 'Kyoto/Tokyo', price: 750, perPerson: true, category: 'culture',
      lat: 35.0116, lng: 135.7681,
      image: 'https://images.unsplash.com/photo-1515823064-d6e0c04616a7?w=800',
      description: 'Zen felsefesinin √∂z√ºn√º ya≈üayƒ±n! Matcha hazƒ±rlama sanatƒ±, wagashi tatlƒ±larƒ±, meditasyon... Sessizlik ve huzur i√ßinde Japon estetiƒüini ke≈üfedin.',
      tips: ['Urasenke veya Camellia √ßay evleri √ºnl√º', 'Tatami\'de oturmak zor olabilir, sandalyeli se√ßenek var', '45-60 dk s√ºr√ºyor', 'ƒ∞ngilizce seremoni se√ßenekleri mevcut'],
      youtube: 'Hm-n_uzzE64'
    },
    {
      id: 'geisha', icon: 'üé≠', name: 'Gion Geisha B√∂lgesi',
      location: 'Kyoto - Gion', price: 500, perPerson: true, category: 'culture',
      lat: 35.0037, lng: 135.7750,
      image: 'https://images.unsplash.com/photo-1493780474015-ba834fd0ce2f?w=800',
      description: 'Japonya\'nƒ±n en √ºnl√º geisha b√∂lgesi! Ak≈üam saatlerinde maiko (√ßƒ±rak geisha) ve geiko (usta geisha) g√∂rme ≈üansƒ±nƒ±z var. Tarihi ah≈üap evler, √ßay evleri...',
      tips: ['Ak≈üam 17-19 arasƒ± maiko g√∂rebilirsiniz', 'Fotoƒüraf √ßekerken mesafeli olun', 'Gion Corner\'da geisha g√∂sterisi var', 'Pontocho sokaƒüƒ± da g√ºzel'],
      youtube: 'eMpKUDhglSU'
    },
    {
      id: 'sumo', icon: 'ü§º', name: 'Sumo Antrenmanƒ± ƒ∞zleme',
      location: 'Tokyo', price: 750, perPerson: true, category: 'culture',
      lat: 35.6966, lng: 139.7932,
      image: 'https://images.unsplash.com/photo-1540959733332-eab4deabeeaf?w=800',
      description: 'Sumo g√ºre≈ü√ßilerinin sabah antrenmanƒ±nƒ± izleyin! Geleneksel ahaylar (sumo evi), terli g√ºre≈üler, chanko nabe (sumo yemeƒüi). Japonya\'nƒ±n ulusal sporu.',
      tips: ['Sabah 7-10 arasƒ± antrenman', 'Arashio-beya veya Musashigawa-beya', 'Rezervasyon ≈üart, yerler sƒ±nƒ±rlƒ±', 'Sessiz olun, bu ciddi bir antrenman'],
      youtube: 'aGQk8EvNl2s'
    },
    {
      id: 'onsen', icon: '‚ô®Ô∏è', name: 'Onsen Deneyimi',
      location: 'Hakone/Beppu', price: 500, perPerson: true, category: 'culture',
      lat: 35.2325, lng: 139.1069,
      image: 'https://images.unsplash.com/photo-1553653924-39b70295f8da?w=800',
      description: 'Volkanik sƒ±cak su kaynaklarƒ±nda rahatlayƒ±n! A√ßƒ±k hava (rotenburo) ve kapalƒ± havuzlar. Japon banyo k√ºlt√ºr√º, etiketi ve rit√ºellerini ya≈üayƒ±n.',
      tips: ['D√∂vme yasaƒüƒ± olan yerler var, √∂nceden kontrol edin', 'Havuza girmeden √∂nce iyice yƒ±kanƒ±n', 'Havlu suya girmiyor', 'Hakone, Tokyo\'dan 1.5 saat'],
      youtube: 'UZL0FKx_C2M'
    },
    {
      id: 'karaoke', icon: 'üé§', name: 'Karaoke Gecesi',
      location: 'Her yerde', price: 500, perPerson: true, category: 'culture',
      lat: 35.6938, lng: 139.7034,
      image: 'https://images.unsplash.com/photo-1516450360452-9312f5e86fc7?w=800',
      description: 'Japonya\'nƒ±n vazge√ßilmez gece aktivitesi! √ñzel odalar, binlerce ≈üarkƒ±, i√ßki dahil paketler. Utanga√ßlƒ±ƒüƒ± atƒ±n, Japon pop m√ºziƒüi deneyin!',
      tips: ['Big Echo, Karaoke Kan zincirleri yaygƒ±n', 'Nomihoudai (i√ßki dahil) paketleri var', 'ƒ∞ngilizce ≈üarkƒ± ar≈üivi geni≈ü', 'Gece yarƒ±sƒ±ndan sonra ucuzlar'],
      youtube: 'z92bmlcmyq0'
    },

    // üóª DOƒûA & MANZARA
    {
      id: 'fuji', icon: 'üóª', name: 'Fuji Daƒüƒ± G√ºnl√ºk Tur',
      location: 'Tokyo √ßevresi', price: 2400, perPerson: true, category: 'nature',
      lat: 35.3606, lng: 138.7274,
      image: 'https://images.unsplash.com/photo-1490806843957-31f4c9a91c65?w=800',
      description: 'Japonya\'nƒ±n simgesi 3.776 m! Be≈ü G√∂ller b√∂lgesi (Kawaguchiko), Chureito Pagoda, maƒüaralar, manzara noktalarƒ±. Her mevsim farklƒ± g√ºzellik.',
      tips: ['Hava durumunu kontrol edin, bulutlu olabilir', 'Kawaguchiko\'da konaklama d√º≈ü√ºn√ºn', 'Kƒ±≈ü aylarƒ±nda kar muhte≈üem', 'Ropeway ile Kachi Kachi daƒüƒ±na √ßƒ±kƒ±n'],
      youtube: 'pU3GWAZU944'
    },
    {
      id: 'hakone', icon: 'üö†', name: 'Hakone G√ºnl√ºk Tur',
      location: 'Kanagawa', price: 1500, perPerson: true, category: 'nature',
      lat: 35.2325, lng: 139.1069,
      image: 'https://images.unsplash.com/photo-1545569341-9eb8b30979d9?w=800',
      description: 'Teleferik, korsan gemi, jigokudani (cehennem vadisi), m√ºzeler ve tabii ki onsen! Hakone Free Pass ile t√ºm ula≈üƒ±m dahil. Fuji manzarasƒ± bonus.',
      tips: ['Hakone Free Pass alƒ±n (Shinjuku\'dan)', 'Owakudani\'de kara yumurta yiyin (7 yƒ±l √∂m√ºr!)', 'Open Air Museum harika', 'Ryokan (geleneksel otel) deneyin'],
      youtube: 'rE7YK5Z_nkA'
    },
    {
      id: 'nikko', icon: 'üçÅ', name: 'Nikko Tapƒ±naklarƒ±',
      location: 'Tochigi', price: 1200, perPerson: true, category: 'nature',
      lat: 36.7578, lng: 139.5985,
      image: 'https://images.unsplash.com/photo-1576675466969-38eeae4b41f6?w=800',
      description: 'UNESCO D√ºnya Mirasƒ±! Toshogu t√ºrbesi, "See no evil" maymunlarƒ±, Kegon ≈üelalesi, Chuzenji g√∂l√º. Doƒüa ve tarih bir arada, sonbaharda efsanevi.',
      tips: ['Tokyo\'dan 2 saat (Tobu Nikko Pass)', 'Sonbahar (Kasƒ±m) en g√ºzel zaman', 'Toshogu √ßok i≈ülemeli, detaylara dikkat', 'Yuba (tofu kabuƒüu) yerel lezzet'],
      youtube: 'a9gO4FhxzvM'
    },

    // üöÑ ULA≈ûIM
    {
      id: 'jrpass7', icon: 'üöÑ', name: 'JR Pass (7 G√ºn)',
      location: 'T√ºm Japonya', price: 12000, perPerson: true, category: 'transport',
      lat: null, lng: null,
      image: 'https://images.unsplash.com/photo-1540959733332-eab4deabeeaf?w=800',
      description: 'Shinkansen dahil t√ºm JR trenlerinde sƒ±nƒ±rsƒ±z seyahat! Tokyo-Kyoto tek y√∂n 13.000¬•, yani 2 yolculukta bile amorti. Japonya\'yƒ± ke≈üfetmenin en iyi yolu.',
      tips: ['Sadece turistler alabilir, Japonya\'ya girmeden √∂nce sipari≈ü edin', 'Nozomi ve Mizuho trenlerinde ge√ßerli DEƒûƒ∞L', 'Hikari ve Sakura trenlerini kullanƒ±n', 'Ye≈üil (Green) wagon i√ßin ayrƒ± pass var'],
      youtube: 'cNlMTPjRXMA'
    },
    {
      id: 'jrpass14', icon: 'üöÑ', name: 'JR Pass (14 G√ºn)',
      location: 'T√ºm Japonya', price: 19200, perPerson: true, category: 'transport',
      lat: null, lng: null,
      image: 'https://images.unsplash.com/photo-1540959733332-eab4deabeeaf?w=800',
      description: 'Uzun seyahatler i√ßin ideal! Hiroshima, Kanazawa, Sapporo... Japonya\'nƒ±n her k√∂≈üesine ula≈üƒ±n. Shinkansen konforu, dakik hareket.',
      tips: ['7 g√ºnl√ºk ile aynƒ± kurallar ge√ßerli', 'Kuzey Japonya (Tohoku) i√ßin √ßok iyi deƒüer', 'Kyushu veya Hokkaido\'ya da gidiyorsanƒ±z ≈üart', 'Exchange order ile Japonya\'da aktive edin'],
      youtube: 'cNlMTPjRXMA'
    },
    {
      id: 'suica', icon: 'üí≥', name: 'Suica/Pasmo IC Kart',
      location: 'T√ºm Japonya', price: 120, perPerson: true, category: 'transport',
      lat: null, lng: null,
      image: 'https://images.unsplash.com/photo-1540959733332-eab4deabeeaf?w=800',
      description: 'Temassƒ±z √∂deme kartƒ±! Metro, otob√ºs, tren, hatta marketler ve otomatlarda kullanƒ±labilir. Japonya\'da c√ºzdanƒ±nƒ±zdan daha √ßok kullanacaksƒ±nƒ±z.',
      tips: ['Havalimanƒ±nda veya JR istasyonlarƒ±nda alƒ±n', '500¬• depozito var (iade edilebilir)', 'Welcome Suica i√ßin depozito yok', 'Apple Pay ile iPhone\'a da eklenebilir'],
      youtube: 'o7fFw3lEi7E'
    },

    // üõçÔ∏è ALI≈ûVERƒ∞≈û B√ñLGELERƒ∞
    {
      id: 'akihabara', icon: 'üéÆ', name: 'Akihabara',
      location: 'Tokyo', price: 0, perPerson: false, category: 'shopping',
      lat: 35.7022, lng: 139.7741,
      image: 'https://images.unsplash.com/photo-1513407030348-c983a97b98d8?w=800',
      description: 'Elektronik ve anime cenneti! Yodobashi Camera, manga d√ºkkanlarƒ±, maid cafeler, retro oyun maƒüazalarƒ±, Gundam fig√ºrleri... Otaku k√ºlt√ºr√ºn√ºn kalbi.',
      tips: ['Yodobashi Camera devasa (8 kat elektronik)', 'Super Potato retro oyun cenneti', 'Maid cafe deneyin (en azƒ±ndan bir kez)', 'Gece neon ƒ±≈üƒ±klarƒ± √ßok g√ºzel'],
      youtube: '7j0SkFgJFgM'
    },
    {
      id: 'harajuku', icon: 'üåà', name: 'Harajuku & Takeshita',
      location: 'Tokyo', price: 0, perPerson: false, category: 'shopping',
      lat: 35.6702, lng: 139.7026,
      image: 'https://images.unsplash.com/photo-1542051841857-5f90071e7989?w=800',
      description: 'Tokyo\'nun en renkli b√∂lgesi! Takeshita Caddesi, vintage d√ºkkanlar, crepe standlarƒ±, kawaii k√ºlt√ºr. Gen√ßlik modasƒ± ve street style\'ƒ±n merkezi.',
      tips: ['Hafta sonu √ßok kalabalƒ±k', 'Marion Crepes efsanevi', 'Cat Street daha sakin ve butik', 'Meiji Shrine\'a y√ºr√ºme mesafesinde'],
      youtube: 'pnW-VNXuFog'
    },
    {
      id: 'shibuya', icon: 'üö∂', name: 'Shibuya Crossing',
      location: 'Tokyo', price: 0, perPerson: false, category: 'shopping',
      lat: 35.6595, lng: 139.7004,
      image: 'https://images.unsplash.com/photo-1542051841857-5f90071e7989?w=800',
      description: 'D√ºnyanƒ±n en kalabalƒ±k kav≈üaƒüƒ±! Her ye≈üil ƒ±≈üƒ±kta 3.000 ki≈üi kar≈üƒ±dan kar≈üƒ±ya. Hachiko heykeli, alƒ±≈üveri≈ü merkezleri, gece hayatƒ±. Tokyo\'nun nabzƒ± burada atar.',
      tips: ['Starbucks\'tan yukarƒ±dan izleyin', 'Mag\'s Park rooftop da iyi a√ßƒ±', 'Hachiko heykeli bulu≈üma noktasƒ±', 'Shibuya Sky g√∂zlem kulesi yeni ve muhte≈üem'],
      youtube: 'gGLP6T6K-bE'
    },
    {
      id: 'dotonbori', icon: 'ü¶Ä', name: 'Dotonbori',
      location: 'Osaka', price: 0, perPerson: false, category: 'shopping',
      lat: 34.6687, lng: 135.5013,
      image: 'https://images.unsplash.com/photo-1590559899731-a382839e5549?w=800',
      description: 'Osaka\'nƒ±n neon cenneti! Glico ko≈üucusu, dev yenge√ß tabelasƒ±, takoyaki, okonomiyaki... Yemek cennetinde gece y√ºr√ºy√º≈ü√º. "Kuidaore" (yiyerek batma) burada ya≈üanƒ±r.',
      tips: ['Gece neon ƒ±≈üƒ±klarƒ± √ßok g√ºzel', 'Takoyaki ve okonomiyaki deneyin', 'Kuromon Market yakƒ±nƒ±nda (sabah kahvaltƒ±)', 'Shinsaibashi alƒ±≈üveri≈ü caddesi de burada'],
      youtube: 'wL_6gPe2LNM'
    }
  ];

  const CATEGORIES = {
    theme: { icon: 'üé¢', name: 'Tema Parklarƒ± & Eƒülence' },
    temple: { icon: '‚õ©Ô∏è', name: 'Tapƒ±naklar & Tarihi Yerler' },
    food: { icon: 'üçú', name: 'Yemek Deneyimleri' },
    culture: { icon: 'üé≠', name: 'K√ºlt√ºrel Deneyimler' },
    nature: { icon: 'üóª', name: 'Doƒüa & Manzara' },
    transport: { icon: 'üöÑ', name: 'Ula≈üƒ±m' },
    shopping: { icon: 'üõçÔ∏è', name: 'Alƒ±≈üveri≈ü B√∂lgeleri' }
  };

  // --- 9 G√ºnl√ºk Gezi Planƒ± ---
  const TRIP_PLAN = [
    {
      day: 1,
      city: 'osaka',
      title: 'Osaka\'ya Varƒ±≈ü!',
      subtitle: 'I≈üƒ±klar, Neonlar ve Lezzetler üåÉ',
      emoji: 'üõ¨',
      activities: [
        { time: 'Ak≈üam', type: 'photo', icon: 'üì∏', name: 'Dotonbori I≈üƒ±k ≈ûovu', desc: 'Kanal y√ºr√ºy√º≈ü√º + √ºnl√º Glico ko≈üucusu ile selfie!', tip: 'En g√ºzel fotoƒüraflar g√ºne≈ü battƒ±ktan sonra √ßƒ±kar' },
        { time: '', type: 'food', icon: 'üêô', name: 'Takoyaki Zamanƒ±', desc: 'Sƒ±cak sƒ±cak ahtapotlu toplar - dikkat dil yakar!' },
        { time: '', type: 'food', icon: 'ü•û', name: 'Okonomiyaki', desc: 'Japon pizzasƒ±! ƒ∞√ßine istediƒüini koy, sosla ye' },
        { time: '', type: 'food', icon: 'üç¢', name: 'Kushikatsu', desc: '√áƒ±tƒ±r √ßƒ±tƒ±r kƒ±zartƒ±lmƒ±≈ü ≈üi≈üler - sosu iki kere BANMA!' }
      ],
      foods: ['Takoyaki', 'Okonomiyaki', 'Kushikatsu'],
      highlight: { title: '‚≠ê G√ºn√ºn Yƒ±ldƒ±zƒ±', text: 'Glico tabelasƒ± √∂n√ºnde aile fotoƒürafƒ± √ßektir!' }
    },
    {
      day: 2,
      city: 'osaka',
      title: 'Osaka Ke≈üfi',
      subtitle: 'Akvaryum veya Kale + Alƒ±≈üveri≈ü üèØ',
      emoji: 'üêã',
      activities: [
        { time: 'Sabah', type: 'activity', icon: 'üêã', name: 'Osaka Akvaryum Kaiyukan', desc: 'Dev balina k√∂pekbalƒ±ƒüƒ±! D√ºnyanƒ±n en b√ºy√ºk akvaryumlarƒ±ndan', tip: 'Online bilet alƒ±rsan kuyruk yok' },
        { time: 'VEYA', type: 'activity', icon: 'üèØ', name: 'Osaka Kalesi', desc: 'Ninja gibi hisset! Park ve bah√ßelerde ko≈ü', tip: 'Kaleye √ßƒ±kmak √ºcretli ama park √ºcretsiz' },
        { time: 'Ak≈üam', type: 'activity', icon: 'üõçÔ∏è', name: 'Namba / Shinsaibashi', desc: 'Dev alƒ±≈üveri≈ü sokaƒüƒ± + sokak lezzetleri' },
        { time: '', type: 'food', icon: 'üçú', name: 'Sokak Yemekleri', desc: 'Gyoza, karaage, matcha dondurma...' }
      ],
      foods: ['Gyoza', 'Karaage', 'Matcha Dondurma'],
      highlight: { title: 'üí° Anne-Baba ƒ∞pucu', text: 'Bug√ºn rahat tempo - √ßocuk yorulmasƒ±n!' }
    },
    {
      day: 3,
      city: 'osaka',
      title: 'UNIVERSAL STUDIOS! üé¢',
      subtitle: 'T√ºm g√ºn eƒülence - Super Nintendo World! üçÑ',
      emoji: 'üéÆ',
      activities: [
        { time: 'Sabah', type: 'activity', icon: '‚è∞', name: 'Erken Kalk!', desc: 'Park a√ßƒ±lƒ±≈üƒ±na git - kuyruklar %70 azalƒ±r', tip: 'A√ßƒ±lƒ±≈ütan 30 dk √∂nce kapƒ±da ol' },
        { time: '', type: 'activity', icon: 'üçÑ', name: 'Super Nintendo World', desc: 'Mario\'nun d√ºnyasƒ±na gir! Ger√ßek Mario Kart s√ºr!', tip: 'Timed Entry uygulamadan al - ZORUNLU!' },
        { time: '', type: 'activity', icon: 'ü¶ñ', name: 'Jurassic Park', desc: 'Dinozorlarƒ±n arasƒ±nda! Su sƒ±√ßramasƒ±na dikkat üí¶' },
        { time: '', type: 'activity', icon: 'üï∑Ô∏è', name: 'Spider-Man / Minions', desc: 'Daha fazla macera!' },
        { time: 'Ak≈üam', type: 'sleep', icon: 'üò¥', name: 'Yorgun ama Mutlu', desc: 'Bug√ºn erken yat - yarƒ±n Kyoto!' }
      ],
      foods: ['Park i√ßi yemekler', 'Mario temalƒ± burgerler'],
      highlight: { title: 'üéüÔ∏è √ñNEMLƒ∞', text: 'Express Pass alƒ±rsan g√ºn kurtarƒ±r! Nintendo i√ßin √∂zellikle ≈üart.' }
    },
    {
      day: 4,
      city: 'kyoto',
      title: 'Kyoto Macerasƒ± Ba≈ülƒ±yor!',
      subtitle: 'Bambu Ormanƒ± - Film Sahnesi Gibi! üéã',
      emoji: 'üéã',
      travel: { from: 'Osaka', to: 'Kyoto', duration: '15 dk', type: 'tren' },
      activities: [
        { time: 'Sabah', type: 'activity', icon: 'üéã', name: 'Arashiyama Bambu Ormanƒ±', desc: 'Y√ºzlerce dev bambu arasƒ±nda y√ºr√º - sihirli!', tip: 'Sabah 7-8 arasƒ± git, kimse olmaz' },
        { time: '√ñƒülen', type: 'photo', icon: 'üåâ', name: 'Togetsukyo K√∂pr√ºs√º', desc: 'Ay Ge√ßi≈ü K√∂pr√ºs√º - nehir kenarƒ±nda piknik' },
        { time: '', type: 'activity', icon: 'üêí', name: 'Maymun Parkƒ±', desc: 'Tepede yabani maymunlar! Besleme ≈üansƒ±' },
        { time: 'Ak≈üam', type: 'sleep', icon: 'üèÆ', name: 'Sakin Sokaklar', desc: 'Kyoto\'nun eski mahallelerinde y√ºr√ºy√º≈ü' }
      ],
      foods: ['Soba', 'Udon', 'Matcha Tatlƒ±'],
      highlight: { title: 'üì∏ Fotoƒüraf ƒ∞pucu', text: 'Bambu ormanƒ±nda yukarƒ± bak ve fotoƒüraf √ßek!' }
    },
    {
      day: 5,
      city: 'kyoto',
      title: 'Kƒ±rmƒ±zƒ± Kapƒ±lar & Market',
      subtitle: 'Binlerce Torii Kapƒ±sƒ± - G√∂rev Gibi! ‚õ©Ô∏è',
      emoji: '‚õ©Ô∏è',
      activities: [
        { time: 'Sabah', type: 'activity', icon: '‚õ©Ô∏è', name: 'Fushimi Inari', desc: '10.000 kƒ±rmƒ±zƒ± kapƒ±! Tepeden ≈üehri g√∂r', tip: 'Video oyunu gibi d√º≈ü√ºn - her kapƒ± bir level!' },
        { time: '√ñƒülen', type: 'food', icon: 'üç°', name: 'Nishiki Market', desc: 'Atƒ±≈ütƒ±rmalƒ±k cenneti! Her ≈üeyi dene', tip: 'Matcha dondurma ve mochi ka√ßƒ±rma' },
        { time: 'Ak≈üam', type: 'activity', icon: 'üõï', name: 'Kiyomizu-dera', desc: 'U√ßan sahne! ≈ûehrin √ºst√ºnde tapƒ±nak' },
        { time: '', type: 'photo', icon: 'üëò', name: 'Gion Y√ºr√ºy√º≈ü√º', desc: 'Gey≈üa g√∂rebilirsin! (sessizce izle)' }
      ],
      foods: ['Mochi', 'Matcha Her ≈ûey', 'Yaki Dango'],
      highlight: { title: 'üèÜ √áocuk G√∂revi', text: '100 kapƒ±dan ge√ß, dilekte bulun, g√∂rev tamam!' }
    },
    {
      day: 6,
      city: 'nara',
      title: 'Geyiklerle Tanƒ±≈ü!',
      subtitle: 'Nara + Tokyo\'ya Tren Yolculuƒüu ü¶å',
      emoji: 'ü¶å',
      travel: { from: 'Kyoto', to: 'Tokyo', duration: '2s 15dk', type: 'shinkansen' },
      activities: [
        { time: 'Sabah', type: 'activity', icon: 'ü¶å', name: 'Nara Park', desc: 'Y√ºzlerce sevimli geyik! Bisk√ºvi al, besle', tip: 'Geyikler eƒüilince sen de eƒüil - selam veriyorlar!' },
        { time: '', type: 'activity', icon: 'üõï', name: 'Todai-ji Tapƒ±naƒüƒ±', desc: 'D√ºnyanƒ±n en b√ºy√ºk bronz Buda heykeli!' },
        { time: '√ñƒüleden Sonra', type: 'travel', icon: 'üöÑ', name: 'Shinkansen!', desc: 'Kyoto ‚Üí Tokyo! Hƒ±z treni deneyimi - 300 km/s', tip: 'Pencere kenarƒ± al, Fuji Daƒüƒ±\'nƒ± g√∂rebilirsin!' },
        { time: 'Ak≈üam', type: 'sleep', icon: 'üè®', name: 'Tokyo Oteli', desc: 'Check-in + yakƒ±n √ßevrede y√ºr√ºy√º≈ü' }
      ],
      foods: ['Kakinoha-zushi', 'Eki-ben (tren kutusu)'],
      highlight: { title: 'üöÖ Shinkansen Macerasƒ±', text: '300 km/s hƒ±zla u√ßuyorsun! Eki-ben al ve trende ye!' }
    },
    {
      day: 7,
      city: 'tokyo',
      title: 'Tokyo Klasikleri',
      subtitle: 'Tapƒ±nak, Park ve Shibuya √áƒ±lgƒ±nlƒ±ƒüƒ± üóº',
      emoji: '‚õ©Ô∏è',
      activities: [
        { time: 'Sabah', type: 'activity', icon: 'üèØ', name: 'Senso-ji & Asakusa', desc: 'Tokyo\'nun en eski tapƒ±naƒüƒ± + alƒ±≈üveri≈ü sokaƒüƒ±', tip: 'Nakamise sokaƒüƒ±nda hediyelik al' },
        { time: '√ñƒülen', type: 'activity', icon: 'üå≥', name: 'Ueno Park', desc: 'Dev park! G√∂l, hayvanat bah√ßesi, m√ºzeler' },
        { time: 'Ak≈üam', type: 'photo', icon: 'üö∂', name: 'Shibuya Kav≈üaƒüƒ±', desc: 'D√ºnyanƒ±n en kalabalƒ±k kav≈üaƒüƒ±! Ortasƒ±nda dur', tip: 'Starbucks\'tan izle, sonra ortasƒ±nda y√ºr√º' },
        { time: '', type: 'food', icon: 'üçú', name: 'Ramen Gecesi', desc: 'Ger√ßek Tokyo rameni dene!' }
      ],
      foods: ['Ramen', 'Melon Pan', 'Taiyaki'],
      highlight: { title: 'üé¨ Film Sahnesi', text: 'Shibuya kav≈üaƒüƒ±nda herkes seninle y√ºr√ºyor!' }
    },
    {
      day: 8,
      city: 'tokyo',
      title: 'TOKYO Dƒ∞SNEYLAND! üè∞',
      subtitle: 'B√ºy√ºl√º Krallƒ±k - T√ºm G√ºn Masal üé†',
      emoji: 'üè∞',
      activities: [
        { time: 'Sabah', type: 'activity', icon: 'üè∞', name: 'Sihirli Kale', desc: 'Sindirella\'nƒ±n kalesine gir!', tip: 'Premier Access uygulamadan al' },
        { time: '', type: 'activity', icon: 'üöÄ', name: 'Space Mountain', desc: 'Karanlƒ±kta uzay yolculuƒüu!' },
        { time: '', type: 'activity', icon: 'üëª', name: 'Haunted Mansion', desc: '999 hayalet! Ama sevimli korku' },
        { time: '', type: 'activity', icon: 'üé†', name: 'It\'s a Small World', desc: 'T√ºm d√ºnyayƒ± 15 dakikada gez!' },
        { time: 'Ak≈üam', type: 'photo', icon: 'üéÜ', name: 'Gece G√∂sterisi', desc: 'Havai fi≈üek + projekt√∂r show!' }
      ],
      foods: ['Mickey ≈üekilli yemekler', 'Popcorn', 'Churros'],
      highlight: { title: 'üé¢ Tercih', text: 'Disneyland = √ßocuk dostu | DisneySea = daha b√ºy√ºkler i√ßin' }
    },
    {
      day: 9,
      city: 'tokyo',
      title: 'teamLab & Veda',
      subtitle: 'I≈üƒ±k M√ºzesi + Son Alƒ±≈üveri≈ü üåà',
      emoji: '‚ú®',
      activities: [
        { time: 'Sabah', type: 'activity', icon: '‚ú®', name: 'teamLab Borderless', desc: 'Sihirli ƒ±≈üƒ±k d√ºnyasƒ±! Duvarlar hareket ediyor', tip: 'Koyu renk giy, ƒ±≈üƒ±klar √ºst√ºnde oynasƒ±n' },
        { time: 'VEYA', type: 'activity', icon: 'üíß', name: 'teamLab Planets', desc: 'Suyun i√ßinde y√ºr√º! Duyusal deneyim', tip: 'Diz altƒ± ≈üort/etek giy, ƒ±slak olursun' },
        { time: '√ñƒülen', type: 'activity', icon: 'üõçÔ∏è', name: 'Son Alƒ±≈üveri≈ü', desc: 'Odaiba veya Ginza\'da son hediyeler' },
        { time: 'Ak≈üam', type: 'travel', icon: '‚úàÔ∏è', name: 'Havalimanƒ±', desc: 'Sayonara Japonya! G√∂r√º≈ümek √ºzere üëã' }
      ],
      foods: ['Son ramen', 'Havalimanƒ± bento'],
      highlight: { title: '‚úàÔ∏è U√ßu≈ü ƒ∞pucu', text: 'Sabah u√ßu≈üunuz varsa teamLab\'i G√ºn 7\'ye al!' }
    }
  ];

  function renderTimeline() {
    const container = byId('tripTimeline');
    if (!container) return;
    
    let html = '';
    
    TRIP_PLAN.forEach((day, index) => {
      // Travel indicator between days
      if (day.travel && index > 0) {
        html += `
          <div class="travel-indicator">
            <div class="travel-badge">
              üöÑ ${day.travel.from} ‚Üí ${day.travel.to} (${day.travel.duration})
            </div>
          </div>
        `;
      }
      
      html += `
        <div class="timeline-day" data-day="${day.day}">
          <div class="day-header" onclick="toggleDay(${day.day})">
            <div class="day-number ${day.city}">
              <span class="num">${day.day}</span>
              <span class="label">G√úN</span>
            </div>
            <div class="day-info">
              <div class="day-title">${day.emoji} ${day.title}</div>
              <div class="day-subtitle">${day.subtitle}</div>
            </div>
            <div class="day-toggle">‚ñº</div>
          </div>
          <div class="day-content">
            ${day.activities.map(act => `
              <div class="activity-block">
                <div class="activity-time">${act.time}</div>
                <div class="activity-dot ${act.type}"></div>
                <div class="activity-details">
                  <div class="activity-name">${act.icon} ${act.name}</div>
                  <div class="activity-desc">${act.desc}</div>
                  ${act.tip ? `<div class="activity-tip">${act.tip}</div>` : ''}
                </div>
              </div>
            `).join('')}
            ${day.foods.length > 0 ? `
              <div class="food-items">
                ${day.foods.map(f => `<span class="food-tag">üç¥ ${f}</span>`).join('')}
              </div>
            ` : ''}
            ${day.highlight ? `
              <div class="highlight-box">
                <div class="highlight-title">${day.highlight.title}</div>
                <div class="highlight-text">${day.highlight.text}</div>
              </div>
            ` : ''}
          </div>
        </div>
      `;
    });
    
    container.innerHTML = html;
  }
  
  function toggleDay(dayNum) {
    const dayEl = document.querySelector(`.timeline-day[data-day="${dayNum}"]`);
    if (dayEl) {
      dayEl.classList.toggle('expanded');
    }
  }

  // --- Alƒ±≈üveri≈ü Mekanlarƒ± Veritabanƒ± ---
  const SHOPPING_PLACES = [
    // üóº TOKYO
    {
      id: 'donki', icon: 'üè¨', name: 'Don Quijote (Donki)', city: 'Tokyo',
      description: 'Japonya\'nƒ±n en √ºnl√º discount maƒüazasƒ±! 24 saat a√ßƒ±k, her ≈üey var: elektronik, kozmetik, snack, hediyelik e≈üya, kost√ºmler ve daha fazlasƒ±. Shibuya, Shinjuku ve Akihabara\'da dev ≈üubeleri var.',
      tips: ['Shibuya Mega Donki 24 saat a√ßƒ±k', 'Tax-free i√ßin pasaport getirin', 'Japonya\'ya √∂zel snack\'ler i√ßin en ucuz yer', 'Akihabara ≈üubesi anime √ºr√ºnleri i√ßin harika'],
      image: 'https://images.unsplash.com/photo-1540959733332-eab4deabeeaf?w=800',
      youtube: 'OBpVNyKSqyA',
      lat: 35.6595, lng: 139.6998
    },
    {
      id: 'yodobashi', icon: 'üì∑', name: 'Yodobashi Camera', city: 'Tokyo',
      description: 'Japonya\'nƒ±n en b√ºy√ºk elektronik maƒüazasƒ±! Akihabara\'da 8 katlƒ± dev bina. Kamera, laptop, telefon, oyun konsollarƒ±, ev aletleri, saat ve daha fazlasƒ±. Tax-free!',
      tips: ['Akihabara ≈üubesi 8 kat, her ≈üey var', 'Fiyat pazarlƒ±ƒüƒ± yapƒ±labilir', 'Yodobashi Point Card √ßƒ±kartƒ±n', 'Restoran katƒ± var, yemek molasƒ± i√ßin ideal'],
      image: 'https://images.unsplash.com/photo-1555529669-e69e7aa0ba9a?w=800',
      youtube: 'QH2RpI_IpTQ',
      lat: 35.6986, lng: 139.7713
    },
    {
      id: 'biccamera', icon: 'üì±', name: 'Bic Camera', city: 'Tokyo',
      description: 'Yodobashi\'nin rakibi! Elektronik, kamera, oyun konsollarƒ± i√ßin harika se√ßenekler. Daha merkezi konumlarda ≈üubeleri var. Yurakucho ve Shibuya ≈üubeleri pop√ºler.',
      tips: ['Yurakucho ≈üubesi √ßok merkezi', 'Yodobashi ile fiyat kar≈üƒ±la≈ütƒ±rƒ±n', 'Bic Camera Point Card √ßƒ±kartƒ±n', 'Apple √ºr√ºnleri i√ßin g√ºvenilir'],
      image: 'https://images.unsplash.com/photo-1531297484001-80022131f5a1?w=800',
      youtube: 'pYG_VFWQFGA',
      lat: 35.6745, lng: 139.7634
    },
    {
      id: 'uniqlo', icon: 'üëö', name: 'Uniqlo Ginza Flagship', city: 'Tokyo',
      description: '12 katlƒ± dev Uniqlo! Japonya\'ya √∂zel √ºr√ºnler, limited edition koleksiyonlar, UT (grafik ti≈ü√∂rt) maƒüazasƒ±. D√ºnyada ba≈üka yerde bulamayacaƒüƒ±nƒ±z √ºr√ºnler var.',
      tips: ['12. kat Japonya √∂zel √ºr√ºnleri', 'UT Store\'da anime/oyun ti≈ü√∂rtleri', 'Heattech ve Airism √ºr√ºnleri √ßok ucuz', 'Japonya\'da Uniqlo %30 daha ucuz'],
      image: 'https://images.unsplash.com/photo-1441986300917-64674bd600d8?w=800',
      youtube: 'qQwH17RXQwo',
      lat: 35.6712, lng: 139.7649
    },
    {
      id: 'shibuya109', icon: 'üéÄ', name: 'Shibuya 109', city: 'Tokyo',
      description: 'Japon gen√ß kadƒ±n modasƒ±nƒ±n kalbi! Harajuku stili, Gyaru modasƒ±, aksesuarlar. Kawaii k√ºlt√ºr√ºn√ºn merkezi. 10 kat moda!',
      tips: ['B2 katƒ± kozmetik i√ßin harika', 'Japon gen√ßlerin ne giydiƒüini g√∂r√ºn', 'Fotoƒüraf √ßekmek i√ßin izin alƒ±n', 'Hafta sonu √ßok kalabalƒ±k'],
      image: 'https://images.unsplash.com/photo-1542051841857-5f90071e7989?w=800',
      youtube: 'bK9P3e7b7zI',
      lat: 35.6598, lng: 139.6994
    },
    {
      id: 'tokyuhands', icon: '‚úÇÔ∏è', name: 'Tokyu Hands', city: 'Tokyo',
      description: 'DIY cennetl! Kƒ±rtasiye, ev dekorasyonu, mutfak gere√ßleri, hobi malzemeleri, seyahat aksesuarlarƒ±. Yaratƒ±cƒ± √ºr√ºnler ve benzersiz Japon icatlarƒ±.',
      tips: ['Shibuya ≈üubesi 8 kat', 'Japon kƒ±rtasiye √ºr√ºnleri harika', 'Seyahat aksesuarlarƒ± katƒ± √ßok faydalƒ±', 'Hediyelik i√ßin benzersiz √ºr√ºnler'],
      image: 'https://images.unsplash.com/photo-1513475382585-d06e58bcb0e0?w=800',
      youtube: 'D5ld_C2eoQY',
      lat: 35.6620, lng: 139.6988
    },
    {
      id: 'loft', icon: 'üìì', name: 'LOFT', city: 'Tokyo',
      description: 'Lifestyle maƒüazasƒ±! Kƒ±rtasiye, kozmetik, hediyelik e≈üya, ev aksesuarlarƒ±. Tokyu Hands\'e benzer ama daha modern ve trendy.',
      tips: ['Shibuya ve Ginza ≈üubeleri b√ºy√ºk', 'Japon kƒ±rtasiye markalarƒ±nƒ±n merkezi', 'Kozmetik b√∂l√ºm√º √ßok kapsamlƒ±', 'Mevsimsel √ºr√ºnler √ßok g√ºzel'],
      image: 'https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=800',
      youtube: 'VYsCPjOuLyI',
      lat: 35.6608, lng: 139.7015
    },
    {
      id: 'ginzasix', icon: 'üíé', name: 'Ginza Six', city: 'Tokyo',
      description: 'Tokyo\'nun en l√ºks alƒ±≈üveri≈ü merkezi! Premium markalar, sanat galerileri, √ßatƒ± bah√ßesi. Japonya\'nƒ±n en b√ºy√ºk Dior, LV maƒüazalarƒ± burada.',
      tips: ['√áatƒ± bah√ßesi √ºcretsiz ve harika manzara', 'B2 kat Japon gourmet yemekleri', 'Sanat eserleri ve sergiler var', 'Tax-free lounge √ßok l√ºks'],
      image: 'https://images.unsplash.com/photo-1555529669-2269763671c0?w=800',
      youtube: 'J7JYrBlxlIY',
      lat: 35.6697, lng: 139.7635
    },
    // üèØ OSAKA
    {
      id: 'shinsaibashi', icon: 'üõçÔ∏è', name: 'Shinsaibashi-suji', city: 'Osaka',
      description: '600 metre uzunluƒüunda kapalƒ± alƒ±≈üveri≈ü caddesi! Japonya\'nƒ±n en eski alƒ±≈üveri≈ü b√∂lgelerinden biri. Her t√ºrl√º maƒüaza, restoran ve kafe.',
      tips: ['Dotonbori\'ye y√ºr√ºy√º≈ü mesafesinde', 'Daimarudan ba≈ülayƒ±p Namba\'ya y√ºr√ºy√ºn', 'Drug store\'lar √ßok ucuz', 'Ak≈üamlarƒ± daha canlƒ±'],
      image: 'https://images.unsplash.com/photo-1590559899731-a382839e5549?w=800',
      youtube: 'iJQpHBPfxzM',
      lat: 34.6727, lng: 135.5012
    },
    {
      id: 'nambaparks', icon: 'üå≥', name: 'Namba Parks', city: 'Osaka',
      description: '√áatƒ± bah√ßeli modern AVM! 120+ maƒüaza, 8 katlƒ± bah√ße terasƒ±, sinema ve restoranlar. Osaka\'nƒ±n en g√ºzel alƒ±≈üveri≈ü merkezi.',
      tips: ['√áatƒ± bah√ßesi √ºcretsiz, fotoƒüraf i√ßin harika', '8. kat restoran b√∂lgesi √ßok iyi', 'Namba istasyonuna direkt baƒülƒ±', 'G√ºn batƒ±mƒ±nda √ßatƒ±ya √ßƒ±kƒ±n'],
      image: 'https://images.unsplash.com/photo-1555400038-63f5ba517a47?w=800',
      youtube: 'TyEAD4PGXHQ',
      lat: 34.6621, lng: 135.5016
    },
    {
      id: 'grandfront', icon: 'üè¢', name: 'Grand Front Osaka', city: 'Osaka',
      description: 'Umeda\'daki dev kompleks! 3 bina, 266 maƒüaza. Moda, restoran, showroom\'lar. Osaka istasyonuna direkt baƒülƒ±.',
      tips: ['Osaka Station City\'ye baƒülƒ±', 'Panasonic Center showroom ilgin√ß', 'Kuzey bina restoranlar i√ßin', 'Yaƒümurlu g√ºnler i√ßin ideal'],
      image: 'https://images.unsplash.com/photo-1480796927426-f609979314bd?w=800',
      youtube: 'oXSqBZD-APs',
      lat: 34.7046, lng: 135.4945
    },
    {
      id: 'hepfive', icon: 'üé°', name: 'HEP FIVE', city: 'Osaka',
      description: '√áatƒ±sƒ±nda kƒ±rmƒ±zƒ± d√∂nme dolap olan AVM! Gen√ß moda, anime maƒüazalarƒ±, arkad oyunlarƒ±. D√∂nme dolap Osaka manzarasƒ± i√ßin harika.',
      tips: ['D√∂nme dolap 600 yen, 15 dakika', 'Anime ve manga maƒüazalarƒ± var', 'Gen√ß Japon modasƒ± i√ßin ideal', 'Fotoƒüraf √ßekimi i√ßin ikonik'],
      image: 'https://images.unsplash.com/photo-1493780474015-ba834fd0ce2f?w=800',
      youtube: 'rYpjPVFJ3_0',
      lat: 34.7050, lng: 135.5005
    }
  ];

  // --- State ---
  const KEY = "jp_savings_app_v6";
  const defaults = {
    savings: 100000, tripDate: "", days: 9, adults: 2, children: 1,
    nightly: 6000, daily: 2500, electronics: 30000, fixed: 15000, bufferPct: 10,
    selectedActivities: []
  };

  function loadState() {
    try {
      const raw = localStorage.getItem(KEY);
      return raw ? { ...defaults, ...JSON.parse(raw) } : { ...defaults };
    } catch (e) { return { ...defaults }; }
  }

  function saveState(st) { localStorage.setItem(KEY, JSON.stringify(st)); }

  function getDaysUntil(dateStr) {
    if (!dateStr) return null;
    const target = new Date(dateStr);
    const today = new Date();
    today.setHours(0, 0, 0, 0);
    target.setHours(0, 0, 0, 0);
    return Math.ceil((target - today) / (1000 * 60 * 60 * 24));
  }

  function adjustValue(field, delta) {
    const input = byId(field);
    const display = byId(field + 'Display');
    let val = parseInt(input.value) || 0;
    val = Math.max(field === 'days' ? 1 : 0, val + delta);
    if (field === 'days') val = Math.min(val, 60);
    if (field === 'adults') val = Math.min(val, 10);
    if (field === 'children') val = Math.min(val, 10);
    input.value = val;
    display.textContent = val;
    render();
  }

  // --- Modal ---
  let currentModalActivity = null;

  function openModal(id) {
    const act = ACTIVITIES.find(a => a.id === id);
    if (!act) return;
    currentModalActivity = act;
    const st = getFormState();
    const totalPeople = st.adults + st.children;

    byId('modalImage').src = act.image;
    byId('modalIcon').textContent = act.icon;
    byId('modalTitle').textContent = act.name;
    byId('modalLocation').querySelector('span').textContent = act.location;
    byId('modalLocation').style.display = 'block';
    byId('modalDesc').textContent = act.description;

    // Tips
    let tipsHtml = '';
    act.tips.forEach(tip => {
      tipsHtml += `<div class="modal-tip-item">üí° ${tip}</div>`;
    });
    byId('modalTips').innerHTML = tipsHtml;

    // YouTube Button
    const ytBtn = byId('modalYoutubeBtn');
    if (act.youtube) {
      ytBtn.style.display = 'flex';
      ytBtn.onclick = () => window.open(`https://www.youtube.com/watch?v=${act.youtube}`, '_blank');
    } else {
      ytBtn.style.display = 'none';
    }

    // Map Button
    const mapBtn = byId('modalMapBtn');
    if (act.lat && act.lng) {
      mapBtn.style.display = 'flex';
      mapBtn.onclick = () => window.open(`https://www.google.com/maps/search/?api=1&query=${act.lat},${act.lng}`, '_blank');
    } else {
      mapBtn.style.display = 'none';
    }

    // Price
    const actPrice = act.perPerson ? act.price * totalPeople : act.price;
    byId('modalPrice').textContent = act.price === 0 ? '√úcretsiz' : fmt(actPrice);
    byId('modalPriceNote').textContent = act.perPerson && act.price > 0 ? `${totalPeople} ki≈üi √ó ${fmt(act.price)}` : '';

    // Show footer with add button
    byId('modalBtnContainer').style.display = 'flex';

    // Button
    const btn = byId('modalBtn');
    const isSelected = st.selectedActivities.includes(id);
    btn.textContent = isSelected ? '‚úì Listede' : 'Listeye Ekle';
    btn.className = isSelected ? 'modal-btn added' : 'modal-btn';

    byId('modalOverlay').classList.add('active');
    document.body.style.overflow = 'hidden';
  }

  function closeModal() {
    byId('modalOverlay').classList.remove('active');
    document.body.style.overflow = '';
    currentModalActivity = null;
  }

  function openVideo() {
    if (!currentModalActivity) return;
    const searchQuery = encodeURIComponent(currentModalActivity.name + ' Japan tour 4K');
    window.open(`https://www.youtube.com/results?search_query=${searchQuery}`, '_blank');
  }

  function showOnMap() {
    const st = getFormState();
    const selectedIds = st.selectedActivities || [];
    
    // Get activities with coordinates
    const selectedWithCoords = ACTIVITIES.filter(a => 
      selectedIds.includes(a.id) && a.lat && a.lng
    );
    
    if (selectedWithCoords.length === 0) {
      alert('L√ºtfen haritada g√∂sterilecek aktivite se√ßin!');
      return;
    }
    
    // Build Google Maps URL with multiple markers
    if (selectedWithCoords.length === 1) {
      // Single location
      const a = selectedWithCoords[0];
      const url = `https://www.google.com/maps/search/?api=1&query=${a.lat},${a.lng}`;
      window.open(url, '_blank');
    } else {
      // Multiple locations - use directions mode
      const waypoints = selectedWithCoords.map(a => `${a.lat},${a.lng}`);
      const origin = waypoints[0];
      const destination = waypoints[waypoints.length - 1];
      const middle = waypoints.slice(1, -1).join('|');
      
      let url = `https://www.google.com/maps/dir/?api=1&origin=${origin}&destination=${destination}&travelmode=transit`;
      if (middle) {
        url += `&waypoints=${middle}`;
      }
      window.open(url, '_blank');
    }
  }

  function updateMapButton() {
    const st = getFormState();
    const selectedIds = st.selectedActivities || [];
    const btn = byId('showMapBtn');
    const hint = byId('mapHint');
    
    const selectedWithCoords = ACTIVITIES.filter(a => 
      selectedIds.includes(a.id) && a.lat && a.lng
    );
    
    if (selectedWithCoords.length === 0) {
      btn.disabled = true;
      hint.textContent = 'Haritada g√∂stermek i√ßin aktivite se√ßin';
    } else {
      btn.disabled = false;
      hint.textContent = `${selectedWithCoords.length} konum haritada g√∂sterilecek`;
    }
  }

  // --- ≈ûehir Bazlƒ± Konaklama Planƒ± ---
  const CITY_DATA = {
    'Tokyo': { icon: 'üóº', nights: 0, activities: [], hotelMin: 1500, hotelMax: 3000 },
    'Osaka': { icon: 'üèØ', nights: 0, activities: [], hotelMin: 1200, hotelMax: 2500 },
    'Kyoto': { icon: '‚õ©Ô∏è', nights: 0, activities: [], hotelMin: 1500, hotelMax: 3500 },
    'Nara': { icon: 'ü¶å', nights: 0, activities: [], hotelMin: 1000, hotelMax: 2000 },
    'Hakone': { icon: '‚ô®Ô∏è', nights: 0, activities: [], hotelMin: 2500, hotelMax: 5000 },
    'Yokohama': { icon: 'üåÜ', nights: 0, activities: [], hotelMin: 1200, hotelMax: 2500 },
    'Himeji': { icon: 'üè∞', nights: 0, activities: [], hotelMin: 1000, hotelMax: 2000 },
    'Nikko': { icon: 'üçÅ', nights: 0, activities: [], hotelMin: 1500, hotelMax: 3500 }
  };

  function getCityFromLocation(location) {
    const loc = location.toLowerCase();
    if (loc.includes('tokyo') || loc.includes('maihama') || loc.includes('mitaka') || loc.includes('azabudai')) return 'Tokyo';
    if (loc.includes('osaka') || loc.includes('usj')) return 'Osaka';
    if (loc.includes('kyoto') || loc.includes('fushimi') || loc.includes('gion') || loc.includes('arashiyama')) return 'Kyoto';
    if (loc.includes('nara')) return 'Nara';
    if (loc.includes('hakone') || loc.includes('kanagawa')) return 'Hakone';
    if (loc.includes('yokohama')) return 'Yokohama';
    if (loc.includes('himeji')) return 'Himeji';
    if (loc.includes('nikko') || loc.includes('tochigi')) return 'Nikko';
    if (loc.includes('√ßevresi')) return 'Tokyo'; // Fuji Daƒüƒ± g√ºnl√ºk tur vb.
    return null; // "Her yerde" veya "T√ºm Japonya" gibi
  }

  function getActivityDuration(activity) {
    // Tam g√ºn gerektiren aktiviteler
    const fullDayActivities = ['usj', 'disney', 'disneysea', 'fuji', 'hakone', 'nikko'];
    if (fullDayActivities.includes(activity.id)) return 1;
    // Yarƒ±m g√ºn aktiviteler - 2 tanesi 1 g√ºn
    return 0.5;
  }

  function updateCityBreakdown() {
    const st = getFormState();
    const selectedIds = st.selectedActivities || [];
    
    if (selectedIds.length === 0) {
      byId('cityBreakdown').innerHTML = `
        <div class="no-selection-msg">
          <span class="no-selection-icon">üéØ</span>
          <p>Aktivite se√ßerek konaklama planƒ±nƒ±zƒ± olu≈üturun</p>
        </div>
      `;
      byId('tripSummary').style.display = 'none';
      return;
    }

    // ≈ûehir verilerini sƒ±fƒ±rla
    const cityStats = {};
    Object.keys(CITY_DATA).forEach(city => {
      cityStats[city] = { 
        ...CITY_DATA[city], 
        nights: 0, 
        activities: [],
        duration: 0
      };
    });

    // Se√ßilen aktiviteleri ≈üehirlere g√∂re grupla
    selectedIds.forEach(id => {
      const act = ACTIVITIES.find(a => a.id === id);
      if (!act) return;
      
      const city = getCityFromLocation(act.location);
      if (city && cityStats[city]) {
        cityStats[city].activities.push(act);
        cityStats[city].duration += getActivityDuration(act);
      }
    });

    // Gece sayƒ±sƒ±nƒ± hesapla (duration'a g√∂re yukarƒ± yuvarla)
    Object.keys(cityStats).forEach(city => {
      if (cityStats[city].duration > 0) {
        cityStats[city].nights = Math.ceil(cityStats[city].duration);
      }
    });

    // Sadece aktivite olan ≈üehirleri g√∂ster
    const activeCities = Object.entries(cityStats)
      .filter(([_, data]) => data.activities.length > 0)
      .sort((a, b) => b[1].nights - a[1].nights);

    if (activeCities.length === 0) {
      byId('cityBreakdown').innerHTML = `
        <div class="no-selection-msg">
          <span class="no-selection-icon">üöÑ</span>
          <p>Se√ßilen aktiviteler belirli bir ≈üehre baƒülƒ± deƒüil (JR Pass vb.)</p>
        </div>
      `;
      byId('tripSummary').style.display = 'none';
      return;
    }

    let html = '';
    let totalNights = 0;
    let minHotelCost = 0;
    let maxHotelCost = 0;

    activeCities.forEach(([city, data]) => {
      totalNights += data.nights;
      minHotelCost += data.nights * data.hotelMin;
      maxHotelCost += data.nights * data.hotelMax;

      html += `
        <div class="city-plan-item">
          <div class="city-plan-header">
            <div class="city-plan-name">
              <span>${data.icon}</span>
              ${city}
            </div>
            <div class="city-plan-nights">${data.nights} gece</div>
          </div>
          <div class="city-plan-activities">
            ${data.activities.map(a => `<span class="city-activity-tag">${a.icon} ${a.name}</span>`).join('')}
          </div>
        </div>
      `;
    });

    byId('cityBreakdown').innerHTML = html;

    // √ñzet hesapla ve g√∂ster
    const totalPeople = st.adults + st.children;
    const minTotal = minHotelCost * totalPeople;
    const maxTotal = maxHotelCost * totalPeople;

    byId('tripSummary').style.display = 'block';
    byId('tripSummaryContent').innerHTML = `
      <div class="summary-item">
        <span>üë• Ki≈üi Sayƒ±sƒ±</span>
        <span>${st.adults} yeti≈ükin${st.children > 0 ? ` + ${st.children} √ßocuk` : ''}</span>
      </div>
      <div class="summary-item">
        <span>üèôÔ∏è Ziyaret Edilecek ≈ûehirler</span>
        <span>${activeCities.length} ≈üehir</span>
      </div>
      <div class="summary-item">
        <span>üåô √ñnerilen Konaklama</span>
        <span>${totalNights} gece</span>
      </div>
      <div class="summary-item">
        <span>üìÖ Toplam Gezi S√ºresi</span>
        <span>${totalNights + 1} g√ºn</span>
      </div>
      <div class="summary-total">
        <span>üè® Tahmini Otel Maliyeti</span>
        <span>${fmt(minTotal)} - ${fmt(maxTotal)}</span>
      </div>
    `;
  }

  function toggleFromModal() {
    if (!currentModalActivity) return;
    toggleActivity(currentModalActivity.id);
    const st = getFormState();
    const isSelected = st.selectedActivities.includes(currentModalActivity.id);
    const btn = byId('modalBtn');
    btn.textContent = isSelected ? '‚úì Listede' : 'Listeye Ekle';
    btn.className = isSelected ? 'modal-btn added' : 'modal-btn';
  }

  byId('modalOverlay').addEventListener('click', (e) => {
    if (e.target === byId('modalOverlay')) closeModal();
  });

  // --- Activities ---
  function renderActivities() {
    const st = getFormState();
    const totalPeople = st.adults + st.children;
    let html = '';
    let currentCategory = '';

    ACTIVITIES.forEach(act => {
      if (act.category !== currentCategory) {
        currentCategory = act.category;
        const cat = CATEGORIES[currentCategory];
        html += `<div class="activity-category"><span>${cat.icon}</span>${cat.name}</div>`;
      }

      const isChecked = st.selectedActivities.includes(act.id);
      const actPrice = act.perPerson ? act.price * totalPeople : act.price;
      const priceText = act.price === 0 ? '√úcretsiz' : fmt(actPrice);
      const noteText = act.perPerson && act.price > 0 ? `<div class="activity-price-note">${totalPeople} ki≈üi</div>` : '';

      html += `
        <div class="activity-item ${isChecked ? 'checked' : ''}">
          <div class="activity-checkbox" onclick="toggleActivity('${act.id}')"></div>
          <div class="activity-icon" onclick="openModal('${act.id}')">${act.icon}</div>
          <div class="activity-content" onclick="openModal('${act.id}')">
            <div class="activity-name">${act.name}</div>
            <div class="activity-location">${act.location}</div>
          </div>
          <div class="activity-actions">
            <button class="activity-info-btn" onclick="openModal('${act.id}')">‚ÑπÔ∏è</button>
          </div>
          <div class="activity-price" onclick="toggleActivity('${act.id}')">
            ${priceText}
            ${noteText}
          </div>
        </div>
      `;
    });

    byId('activityList').innerHTML = html;
    updateActivitiesTotal();
    updateMapButton();
    updateCityBreakdown();
  }

  function toggleActivity(id) {
    const st = getFormState();
    const idx = st.selectedActivities.indexOf(id);
    if (idx > -1) st.selectedActivities.splice(idx, 1);
    else st.selectedActivities.push(id);
    saveState(st);
    renderActivities();
    render();
  }

  function updateActivitiesTotal() {
    const st = getFormState();
    const totalPeople = st.adults + st.children;
    let total = 0;
    st.selectedActivities.forEach(id => {
      const act = ACTIVITIES.find(a => a.id === id);
      if (act) total += act.perPerson ? act.price * totalPeople : act.price;
    });
    byId('activitiesTotal').textContent = fmt(total);
    byId('activitiesCount').textContent = `${st.selectedActivities.length} se√ßili`;
    return total;
  }

  function getActivitiesTotal() {
    const st = getFormState();
    const totalPeople = st.adults + st.children;
    let total = 0;
    st.selectedActivities.forEach(id => {
      const act = ACTIVITIES.find(a => a.id === id);
      if (act) total += act.perPerson ? act.price * totalPeople : act.price;
    });
    return total;
  }

  // --- Shopping Functions ---
  let currentShoppingPlace = null;

  function renderShopping() {
    const tokyoPlaces = SHOPPING_PLACES.filter(p => p.city === 'Tokyo');
    const osakaPlaces = SHOPPING_PLACES.filter(p => p.city === 'Osaka');
    
    let html = '';
    
    // Tokyo
    html += `<div class="shopping-city">
      <div class="shopping-city-header">üóº Tokyo</div>
      <div class="shopping-list">`;
    
    tokyoPlaces.forEach(place => {
      html += `
        <div class="shopping-item clickable" onclick="openShoppingModal('${place.id}')">
          <span class="shopping-icon">${place.icon}</span>
          <div class="shopping-info">
            <div class="shopping-name">${place.name}</div>
            <div class="shopping-desc">${place.description.substring(0, 60)}...</div>
          </div>
          <button class="shopping-info-btn">‚ÑπÔ∏è</button>
        </div>
      `;
    });
    
    html += `</div></div>`;
    
    // Osaka
    html += `<div class="shopping-city">
      <div class="shopping-city-header">üèØ Osaka</div>
      <div class="shopping-list">`;
    
    osakaPlaces.forEach(place => {
      html += `
        <div class="shopping-item clickable" onclick="openShoppingModal('${place.id}')">
          <span class="shopping-icon">${place.icon}</span>
          <div class="shopping-info">
            <div class="shopping-name">${place.name}</div>
            <div class="shopping-desc">${place.description.substring(0, 60)}...</div>
          </div>
          <button class="shopping-info-btn">‚ÑπÔ∏è</button>
        </div>
      `;
    });
    
    html += `</div></div>`;
    
    byId('shoppingList').innerHTML = html;
  }

  function openShoppingModal(id) {
    const place = SHOPPING_PLACES.find(p => p.id === id);
    if (!place) return;
    
    currentShoppingPlace = place;
    
    byId('modalImage').src = place.image;
    byId('modalTitle').textContent = place.name;
    byId('modalDesc').textContent = place.description;
    
    // Tips
    let tipsHtml = '';
    place.tips.forEach(tip => {
      tipsHtml += `<div class="modal-tip-item">üí° ${tip}</div>`;
    });
    byId('modalTips').innerHTML = tipsHtml;
    
    // YouTube button
    const ytBtn = byId('modalYoutubeBtn');
    if (place.youtube) {
      ytBtn.style.display = 'flex';
      ytBtn.onclick = () => window.open(`https://www.youtube.com/watch?v=${place.youtube}`, '_blank');
    } else {
      ytBtn.style.display = 'none';
    }
    
    // Hide the add/remove button for shopping
    byId('modalBtnContainer').style.display = 'none';
    
    // Show map button for shopping places
    const mapBtn = byId('modalMapBtn');
    if (place.lat && place.lng) {
      mapBtn.style.display = 'flex';
      mapBtn.onclick = () => window.open(`https://www.google.com/maps/search/?api=1&query=${place.lat},${place.lng}`, '_blank');
    } else {
      mapBtn.style.display = 'none';
    }
    
    byId('modalOverlay').classList.add('active');
  }

  // --- Compute & Render ---
  function compute(st) {
    const fixed = Math.max(0, st.fixed);
    const nightly = Math.max(0, st.nightly);
    const days = Math.max(1, st.days);
    const nights = Math.max(0, days - 1);
    const daily = Math.max(0, st.daily);
    const electronics = Math.max(0, st.electronics);
    const bufferPct = clamp(st.bufferPct || 0, 0, 50) / 100;
    const adults = Math.max(1, st.adults);
    const children = Math.max(0, st.children);
    const totalPeople = adults + children;

    const activitiesTotal = getActivitiesTotal();
    const dailyTotal = daily * totalPeople * days;
    const nightlyTotal = nightly * nights;
    const base = fixed + nightlyTotal + dailyTotal + electronics + activitiesTotal;
    const buffer = base * bufferPct;
    const target = base + buffer;

    const savings = Math.max(0, st.savings);
    const gap = target - savings;
    const pct = target > 0 ? (savings / target) * 100 : 0;

    const daysUntil = getDaysUntil(st.tripDate);
    const weeksUntil = daysUntil ? Math.max(1, Math.ceil(daysUntil / 7)) : null;
    const monthsUntil = daysUntil ? Math.max(1, Math.ceil(daysUntil / 30)) : null;
    const weeklySavingsNeeded = (gap > 0 && weeksUntil) ? gap / weeksUntil : 0;
    const monthlySavingsNeeded = (gap > 0 && monthsUntil) ? gap / monthsUntil : 0;

    return { target, pct, gap, savings, fixed, nights, days, totalPeople, activitiesTotal,
      nightlyTotal, dailyTotal, electronics, daysUntil, weeksUntil, monthsUntil,
      weeklySavingsNeeded, monthlySavingsNeeded, nightly, daily };
  }

  function render() {
    const st = getFormState();
    const c = compute(st);

    const circle = byId('progressCircle');
    const offset = 502 - (clamp(c.pct, 0, 100) / 100) * 502;
    circle.style.strokeDashoffset = offset;

    byId('progressPercent').textContent = Math.round(clamp(c.pct, 0, 999)) + '%';
    byId('progressMessage').textContent = c.gap > 0 
      ? `Hedefe ${fmt(c.gap)} daha gerekiyor`
      : `Hedefi ge√ßtin! +${fmt(-c.gap)} fazla var`;

    if (c.daysUntil !== null && c.daysUntil > 0) {
      byId('countdownDays').textContent = c.daysUntil;
      byId('countdownWeeks').textContent = c.weeksUntil;
      byId('countdownMonths').textContent = c.monthsUntil;
    } else {
      byId('countdownDays').textContent = '‚Äî';
      byId('countdownWeeks').textContent = '‚Äî';
      byId('countdownMonths').textContent = '‚Äî';
    }

    byId('statTarget').textContent = fmt(c.target);
    byId('statSavings').textContent = fmt(c.savings);
    byId('statStay').textContent = `${c.days}G / ${c.nights}G / ${c.totalPeople}K`;

    const gapEl = byId('statGap');
    gapEl.textContent = c.gap > 0 ? '-' + fmt(c.gap) : '+' + fmt(-c.gap);
    gapEl.className = c.gap > 0 ? 'stat-value danger' : 'stat-value success';

    byId('weeklySavings').textContent = c.gap > 0 && c.weeklySavingsNeeded > 0 
      ? fmt(c.weeklySavingsNeeded) : (c.gap <= 0 ? '‚úì Hazƒ±r' : '‚Äî');
    byId('monthlySavings').textContent = c.gap > 0 && c.monthlySavingsNeeded > 0 
      ? fmt(c.monthlySavingsNeeded) : (c.gap <= 0 ? '‚úì Hazƒ±r' : '‚Äî');

    // Analysis
    const list = [];
    list.push(infoItem('üìã', 'Sabit Giderler', `${fmt(c.fixed)}`, c.savings >= c.fixed ? 'success' : 'danger'));
    list.push(infoItem('üè®', 'Konaklama', `${c.nights}G √ó ${fmt(c.nightly)} = ${fmt(c.nightlyTotal)}`, 'success'));
    list.push(infoItem('üçú', 'G√ºnl√ºk', `${c.days}G √ó ${c.totalPeople}K √ó ${fmt(c.daily)} = ${fmt(c.dailyTotal)}`, 'success'));
    if (c.activitiesTotal > 0) list.push(infoItem('üéØ', 'Aktiviteler', `${st.selectedActivities.length} adet = ${fmt(c.activitiesTotal)}`, 'success'));
    list.push(infoItem('üõçÔ∏è', 'Alƒ±≈üveri≈ü', fmt(c.electronics), 'success'));
    byId('analysisList').innerHTML = list.join('');
  }

  function infoItem(icon, title, desc, status) {
    const badges = { success: 'Tamam', warning: 'Kƒ±smi', danger: 'Eksik' };
    return `<div class="info-item">
      <div class="info-item-icon ${status}">${icon}</div>
      <div class="info-item-content"><div class="info-item-title">${title}</div><div class="info-item-desc">${desc}</div></div>
      <span class="info-item-badge ${status}">${badges[status]}</span>
    </div>`;
  }

  // --- Form ---
  function setFormState(st) {
    byId('savings').value = st.savings || '';
    byId('tripDate').value = st.tripDate || '';
    byId('days').value = st.days || 8;
    byId('daysDisplay').textContent = st.days || 8;
    byId('adults').value = st.adults || 2;
    byId('adultsDisplay').textContent = st.adults || 2;
    byId('children').value = st.children || 1;
    byId('childrenDisplay').textContent = st.children || 1;
    byId('nightly').value = st.nightly || '';
    byId('daily').value = st.daily || '';
    byId('electronics').value = st.electronics || '';
    byId('fixed').value = st.fixed || '';
    byId('bufferPct').value = st.bufferPct || '';
  }

  function getFormState() {
    const num = (id) => Number(byId(id).value || 0);
    const saved = loadState();
    return {
      savings: num('savings'), tripDate: byId('tripDate').value || '',
      days: num('days'), adults: num('adults'), children: num('children'),
      nightly: num('nightly'), daily: num('daily'), electronics: num('electronics'),
      fixed: num('fixed'), bufferPct: num('bufferPct'),
      selectedActivities: saved.selectedActivities || []
    };
  }

  // Events
  ['savings', 'tripDate', 'nightly', 'daily', 'electronics', 'fixed', 'bufferPct'].forEach(id => 
    byId(id).addEventListener('input', () => { render(); renderActivities(); })
  );

  byId('saveBtn').addEventListener('click', () => {
    saveState(getFormState());
    const btn = byId('saveBtn');
    btn.textContent = '‚úì Kaydedildi';
    setTimeout(() => btn.textContent = 'üíæ Kaydet', 1500);
  });

  byId('resetBtn').addEventListener('click', () => { localStorage.removeItem(KEY); location.reload(); });

  // Init
  const st0 = loadState();
  if (!st0.tripDate) {
    const future = new Date();
    future.setMonth(future.getMonth() + 6);
    st0.tripDate = future.toISOString().split('T')[0];
  }
  setFormState(st0);
  renderTimeline();
  renderActivities();
  renderShopping();
  render();
</script>
</body>
</html>
